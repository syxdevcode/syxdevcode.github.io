---
title: 线性表之-单链表
date: 2019-07-29 16:04:26
tags:
- 数据结构
- 线性表
- 链表
categories: 
- 链表
---
# 线性表之-单链表

**结构描述：**

1，Data 数据 + Next 指针，组成一个单链表的内存结构 ；
2，第一个内存结构称为 链头，最后一个内存结构称为 链尾；
3，链尾的 Next 指针设置为 NULL [指向空]；
4，单链表的遍历方向单一【只能从链头一直遍历到链尾】

## IListDataStructure`<T>`泛型接口

首先定义 `IListDataStructure<T>`泛型接口:

```cs
public interface IListDataStructure<T>
{
    //取得线性表的实际元素个数
    int Count();

    //清空线性表
    void Clear();

    //判断线性表是否为空
    bool IsEmpty();

    //（在末端）追加元素
    void Append(T item);

    //在位置i“前面”插入元素item
    void InsertBefore(T item, int i);

    //在位置i“后面”插入元素item
    void InsertAfter(T item, int i);

    //删除索引i处的元素
    T RemoveAt(int i);

    //获得索引位置i处的元素
    T GetItemAt(int i);

    //返回元素value的索引
    int IndexOf(T value);

    //反转线性表的所有元素
    void Reverse();
}
```

## Node`<T>`

定义 `Node<T>` 泛型类

```cs
public class Node<T>
{
    private T data;
    private Node<T> next;

    public Node(T val, Node<T> p)
    {
        data = val;
        next = p;
    }

    public Node(Node<T> p)
    {
        next = p;
    }

    public Node(T val)
    {
        data = val;
        next = null;
    }

    public Node()
    {
        data = default(T);
        next = null;
    }

    public T Data
    {
        get { return data; }
        set { data = value; }
    }

    public Node<T> Next
    {
        get { return next; }
        set { next = value; }
    }
}
```

## LinkList`<T>`

定义 `LinkList<T>` 单链表：

```cs
public class LinkList<T> : IListDataStructure<T>
{
    private Node<T> head;

    public Node<T> Head
    {
        get { return head; }
        set { head = value; }
    }

    public LinkList()
    {
        head = null;
    }

    /// <summary>
    /// 类索引器
    /// </summary>
    /// <param name="index"></param>
    /// <returns></returns>
    public T this[int index]
    {
        get
        {
            return this.GetItemAt(index);
        }
    }

    /// <summary>
    /// 返回单链表的长度
    /// </summary>
    /// <returns></returns>
    public int Count()
    {
        Node<T> p = head;
        int len = 0;
        while (p != null)
        {
            len++;
            p = p.Next;
        }
        return len;
    }

    /// <summary>
    /// 清空
    /// </summary>
    public void Clear()
    {
        head = null;
    }

    /// <summary>
    /// 是否为空
    /// </summary>
    /// <returns></returns>
    public bool IsEmpty()
    {
        return head == null;
    }

    /// <summary>
    /// 在最后附加元素
    /// </summary>
    /// <param name="item"></param>
    public void Append(T item)
    {
        Node<T> d = new Node<T>(item);
        Node<T> n = new Node<T>();

        if (head == null)
        {
            head = d;
            return;
        }

        n = head;
        while (n.Next != null)
        {
            n = n.Next;
        }
        n.Next = d;
    }

    //前插
    public void InsertBefore(T item, int i)
    {
        if (IsEmpty() || i < 0)
        {
            Console.WriteLine("List is empty or Position is error!");
            return;
        }

        //在最开头插入
        if (i == 0)
        {
            Node<T> q = new Node<T>(item);
            q.Next = Head;//把"头"改成第二个元素
            head = q;//把自己设置为"头"
            return;
        }

        Node<T> n = head;
        Node<T> d = new Node<T>();
        int j = 0;

        //找到位置i的前一个元素d
        while (n.Next != null && j < i)
        {
            d = n;
            n = n.Next;
            j++;
        }

        if (n.Next == null) //说明是在最后节点插入(即追加)
        {
            Node<T> q = new Node<T>(item);
            n.Next = q;
            q.Next = null;
        }
        else
        {
            if (j == i)
            {
                Node<T> q = new Node<T>(item);
                d.Next = q;
                q.Next = n;
            }
        }
    }

    /// <summary>
    /// 在位置i后插入元素item
    /// </summary>
    /// <param name="item"></param>
    /// <param name="i"></param>
    public void InsertAfter(T item, int i)
    {
        if (IsEmpty() || i < 0)
        {
            Console.WriteLine("List is empty or Position is error!");
            return;
        }

        if (i == 0)
        {
            Node<T> q = new Node<T>(item);
            q.Next = head.Next;
            head.Next = q;
            return;
        }

        Node<T> p = head;
        int j = 0;

        while (p != null && j < i)
        {
            p = p.Next;
            j++;
        }
        if (j == i)
        {
            Node<T> q = new Node<T>(item);
            q.Next = p.Next;
            p.Next = q;
        }
        else
        {
            Console.WriteLine("Position is error!");
        }
    }

    /// <summary>
    /// 删除位置i的元素
    /// </summary>
    /// <param name="i"></param>
    /// <returns></returns>
    public T RemoveAt(int i)
    {
        if (IsEmpty() || i < 0)
        {
            Console.WriteLine("Link is empty or Position is error!");
            return default(T);
        }

        Node<T> q = new Node<T>();
        if (i == 0)
        {
            q = head;
            head = head.Next;
            return q.Data;
        }

        Node<T> p = head;
        int j = 0;

        while (p.Next != null && j < i)
        {
            j++;
            q = p;
            p = p.Next;
        }

        if (j == i)
        {
            q.Next = p.Next;
            return p.Data;
        }
        else
        {
            Console.WriteLine("The node is not exist!");
            return default(T);
        }
    }

    /// <summary>
    /// 获取指定位置的元素
    /// </summary>
    /// <param name="i"></param>
    /// <returns></returns>
    public T GetItemAt(int i)
    {
        if (IsEmpty())
        {
            Console.WriteLine("List is empty!");
            return default(T);
        }

        Node<T> p = new Node<T>();
        p = head;

        if (i == 0)
        {
            return p.Data;
        }

        int j = 0;

        while (p.Next != null && j < i)
        {
            j++;
            p = p.Next;
        }

        if (j == i)
        {
            return p.Data;
        }
        else
        {
            Console.WriteLine("The node is not exist!");
            return default(T);
        }
    }

    //按元素值查找索引
    public int IndexOf(T value)
    {
        if (IsEmpty())
        {
            Console.WriteLine("List is Empty!");
            return -1;
        }
        Node<T> p = new Node<T>();
        p = head;
        int i = 0;
        while (!p.Data.Equals(value) && p.Next != null)
        {
            p = p.Next;
            i++;
        }
        return i;
    }

    /// <summary>
    /// 元素反转
    /// </summary>
    public void Reverse()
    {
        LinkList<T> result = new LinkList<T>();
        Node<T> t = this.head;
        result.Head = new Node<T>(t.Data);
        t = t.Next;

        //(把当前链接的元素从head开始遍历，逐个插入到另一个空链表中，这样得到的新链表正好元素顺序跟原链表是相反的)
        while (t != null)
        {
            result.InsertBefore(t.Data, 0);
            t = t.Next;
        }
        this.head = result.head;//将原链表直接挂到"反转后的链表"上
        result = null;//显式清空原链表的引用，以便让GC能直接回收
    }

    public override string ToString()
    {
        StringBuilder sb = new StringBuilder();
        Node<T> n = this.head;
        sb.Append(n.Data + ",");
        while (n.Next != null)
        {
            sb.Append(n.Next.Data + ",");
            n = n.Next;
        }
        return sb.ToString().TrimEnd(',');
    }
}
```

使用：在Main() 方法调用 `TestLinkList()` 方法：

```cs
public static void TestLinkList()
{
    Console.WriteLine("-------------------------------------");
    Console.WriteLine("单链表测试开始...");
    LinkList<string> link = new LinkList<string>();
    link.Head = new Node<string>("x");
    link.InsertBefore("w", 0);
    link.InsertBefore("v", 0);
    link.Append("y");
    link.InsertBefore("z", link.Count());
    Console.WriteLine(link.Count());//5
    Console.WriteLine(link.ToString());//v,w,x,y,z
    Console.WriteLine(link[1]);//w
    Console.WriteLine(link[0]);//v
    Console.WriteLine(link[4]);//z
    Console.WriteLine(link.IndexOf("z"));//4
    Console.WriteLine(link.RemoveAt(2));//x
    Console.WriteLine(link.ToString());//v,w,y,z
    link.InsertBefore("x", 2);
    Console.WriteLine(link.ToString());//v,w,x,y,z
    Console.WriteLine(link.GetItemAt(2));//x
    link.Reverse();
    Console.WriteLine(link.ToString());//z,y,x,w,v
    link.InsertAfter("1", 0);
    link.InsertAfter("2", 1);
    link.InsertAfter("6", 5);
    link.InsertAfter("8", 7);
    link.InsertAfter("A", 10);//Position is error!

    Console.WriteLine(link.ToString()); //z,1,2,y,x,w,6,v,8
}
```

参考：

[数据结构C#版笔记--单链表(LinkList)](https://www.cnblogs.com/yjmyzz/archive/2010/10/17/1853562.html)