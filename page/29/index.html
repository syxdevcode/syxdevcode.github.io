<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"syxdevcode.github.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="syxdevcode博客">
<meta property="og:url" content="https://syxdevcode.github.com/page/29/index.html">
<meta property="og:site_name" content="syxdevcode博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="syxdevcode">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://syxdevcode.github.com/page/29/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>syxdevcode博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">syxdevcode博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/syxdevcode" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/09/15/CentOS7-PostGresqlSql%E5%AE%89%E8%A3%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/09/15/CentOS7-PostGresqlSql%E5%AE%89%E8%A3%85/" class="post-title-link" itemprop="url">CentOS7-PostGresqlSql9.6安装</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-09-15 14:35:18" itemprop="dateCreated datePublished" datetime="2017-09-15T14:35:18+00:00">2017-09-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PostGresqlSql/" itemprop="url" rel="index"><span itemprop="name">PostGresqlSql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h2><p><a target="_blank" rel="noopener" href="https://www.postgresql.org/download/linux/redhat/" title="链接">官网文档</a></p>
<p>注: root账户安装</p>
<h3 id="添加RPM"><a href="#添加RPM" class="headerlink" title="添加RPM"></a>添加RPM</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-7-x86_64/pgdg-centos96-9.6-3.noarch.rpm</span><br></pre></td></tr></table></figure>

<h3 id="安装PostgreSQL"><a href="#安装PostgreSQL" class="headerlink" title="安装PostgreSQL"></a>安装PostgreSQL</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install postgresql96         ##客户端包##</span><br><span class="line">yum install postgresql96-server  ##服务端包##</span><br></pre></td></tr></table></figure>

<p>安装过程出现问题，可能会导致初始化数据库错误错误，如下：</p>
<p>解决方法：重新执行命令 <code>yum install postgresql96-server</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2zeii3e4srrxcoy1gbubz ~]# /usr/pgsql-9.6/bin/postgresql96-setup initdb</span><br><span class="line">-bash: /usr/pgsql-9.6/bin/postgresql96-setup: No such file or directory</span><br></pre></td></tr></table></figure>

<h3 id="初始化数据库-允许自动启动"><a href="#初始化数据库-允许自动启动" class="headerlink" title="初始化数据库,允许自动启动"></a>初始化数据库,允许自动启动</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/usr/pgsql-9.6/bin/postgresql96-setup initdb</span><br><span class="line">systemctl enable postgresql-9.6</span><br><span class="line">systemctl start postgresql-9.6</span><br></pre></td></tr></table></figure>

<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>PostgreSQL 安装完成后，会建立一下‘postgres’用户，用于执行PostgreSQL，数据库中也会建立一个’postgres’用户，默认密码为自动生成，需要在系统中改一下。</p>
<h3 id="修改默认密码"><a href="#修改默认密码" class="headerlink" title="修改默认密码"></a>修改默认密码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su - postgres  ##切换用户，执行后提示符会变为 &#x27;-bash-4.2$&#x27;</span><br><span class="line">psql -U postgres ##登录数据库，执行后提示符变为 &#x27;postgres=#&#x27;</span><br><span class="line">ALTER USER postgres WITH PASSWORD &#x27;abc123&#x27; ## 设置postgres用户密码</span><br><span class="line">\q       ##退出数据库</span><br><span class="line">exit     ##退出</span><br></pre></td></tr></table></figure>

<h3 id="开启远程访问"><a href="#开启远程访问" class="headerlink" title="开启远程访问"></a>开启远程访问</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /var/lib/pgsql/9.6/data/postgresql.conf</span><br></pre></td></tr></table></figure>

<p> 修改#listen_addresses = ‘localhost’ 为  listen_addresses=’*’</p>
<p> 当然，此处‘*’也可以改为任何你想开放的服务器IP</p>
<h3 id="信任远程连接"><a href="#信任远程连接" class="headerlink" title="信任远程连接"></a>信任远程连接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /var/lib/pgsql/9.6/data/pg_hba.conf</span><br></pre></td></tr></table></figure>

<p>修改如下内容，信任指定服务器连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># IPv4 local connections:</span><br><span class="line">host    all       all      127.0.0.1/32      trust</span><br><span class="line">host    all       all      10.211.55.6/32（需要连接的服务器IP）  trust</span><br></pre></td></tr></table></figure>

<h3 id="打开防火墙"><a href="#打开防火墙" class="headerlink" title="打开防火墙"></a>打开防火墙</h3><p>CentOS 防火墙中内置了PostgreSQL服务，配置文件位置在</p>
<p>/usr/lib/firewalld/services/postgresql.xml，</p>
<p>我们只需以服务方式将PostgreSQL服务开放即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --add-service=postgresql --permanent  开放postgresql服务</span><br><span class="line">firewall-cmd --reload  重载防火墙</span><br></pre></td></tr></table></figure>

<h3 id="重启服务"><a href="#重启服务" class="headerlink" title="重启服务"></a>重启服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart postgresql-9.6.service</span><br></pre></td></tr></table></figure>

<h2 id="开发备注"><a href="#开发备注" class="headerlink" title="开发备注"></a>开发备注</h2><p>本地服务器连接数据库出现以下错误：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OperationalError: FATAL: Ident authentication failed for user “dbuser”</span><br></pre></td></tr></table></figure>

<p>出现这个错误的原因还是在于上面pg_hba.conf 文件的设置，Debian系（包括ubuntu）默认的pg_hba.conf 文件对于</p>
<p>localhost本地机器的数据库访问方式是ident，它指的是只有Linux shell用户通过同名的postgreSQL 用户才能访问，</p>
<p>也就是pg超级用户postgres 只能由linux 用户postgres 登录后操作。</p>
<p>“postgres”的问题，有两种解决方法：</p>
<ul>
<li><p>在执行$ python manage.py shell之前先$su postgres 切换为postgres 用户</p>
</li>
<li><p>修改pg_hba.conf 的客户端访问设置，将laocal 的访问由ident 改为trust，如：</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># TYPE DATABASE USER CIDR-ADDRESS METHOD</span><br><span class="line">local all all trust</span><br></pre></td></tr></table></figure>

<p>修改完pg_hba.conf设置记得重启pg。安装了pg_ctl 也可以用pg_ctl reload。</p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.postgresql.org/download/linux/redhat/" title="链接">官网文档</a></p>
<p><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/7e95fd0bc91a" title="链接">http://www.jianshu.com/p/7e95fd0bc91a</a></p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/mchina/archive/2012/06/06/2539003.html" title="链接">http://www.cnblogs.com/mchina/archive/2012/06/06/2539003.html</a></p>
<p><a target="_blank" rel="noopener" href="http://blog.csdn.net/wang1144/article/details/8986479" title="本地连接错误">http://blog.csdn.net/wang1144/article/details/8986479</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/09/13/CentOS-tar%E5%8E%8B%E7%BC%A9%E8%A7%A3%E5%8E%8B%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/09/13/CentOS-tar%E5%8E%8B%E7%BC%A9%E8%A7%A3%E5%8E%8B%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">Centos-tar压缩解压命令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-09-13 15:09:47" itemprop="dateCreated datePublished" datetime="2017-09-13T15:09:47+00:00">2017-09-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/" itemprop="url" rel="index"><span itemprop="name">Linux基础命令</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Centos-tar压缩解压命令"><a href="#Centos-tar压缩解压命令" class="headerlink" title="Centos-tar压缩解压命令"></a>Centos-tar压缩解压命令</h1><p>文件操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ls      ####查看目录中的文件####</span><br><span class="line">ls -F       ####查看目录中的文件####</span><br><span class="line">ls -l       ####显示文件和目录的详细资料####</span><br><span class="line">ls -a       ####显示隐藏文件####</span><br><span class="line">ls *[0-9]*       ####显示包含数字的文件名和目录名####</span><br><span class="line">rm go.tar       #### 删除go.tar文件####</span><br><span class="line">find mt.cgi       ####查找文件名为mt.cgi的文件####</span><br><span class="line">df ?h       ####查看磁盘剩余空间####</span><br><span class="line">find / -name xxx -print       ####查找xxx文件####</span><br></pre></td></tr></table></figure>

<p>压缩与解压缩：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">tar xvf wordpress.tar       ####解压tar格式的文件####</span><br><span class="line">tar -tvf myfile.tar       ####查看tar文件中包含的文件 ####</span><br><span class="line">tar cf toole.tar tool       ####把tool目录打包为toole.tar文件####</span><br><span class="line">tar cfz xwyme.tar.gz tool      ####把tool目录打包且压缩为xwyme.tar.gz文件，因为.tar文件几乎是没有压缩过的，MT的.tar.gz文件解压成.tar文件后差不多是10MB ####</span><br><span class="line">tar jcvf /var/bak/www.tar.bz2 /var/www/       ####创建.tar.bz2文件，压缩率高####</span><br><span class="line">tar xjf www.tar.bz2       ####解压tar.bz2格式####</span><br><span class="line">gzip -d ge.tar.gz       ####解压.tar.gz文件为.tar文件####</span><br><span class="line">unzip phpbb.zip       ####解压zip文件，windows下要压缩出一个.tar.gz格式的文件还是有点麻烦的####</span><br><span class="line"></span><br><span class="line">bunzip2 file1.bz2       ####解压一个叫做 ‘file1.bz2′的文件####</span><br><span class="line">bzip2 file1       ####压缩一个叫做 ‘file1′ 的文件####</span><br><span class="line">gunzip file1.gz       ####解压一个叫做 ‘file1.gz’的文件####</span><br><span class="line">gzip file1       ####压缩一个叫做 ‘file1′的文件####</span><br><span class="line">gzip -9 file1       ####最大程度压缩####</span><br><span class="line">rar a file1.rar test_file       ####创建一个叫做 ‘file1.rar’ 的包####</span><br><span class="line">rar a file1.rar file1 file2 dir1       ####同时压缩 ‘file1′, ‘file2′ 以及目录 ‘dir1′####</span><br><span class="line">rar x file1.rar       ####解压rar包####</span><br><span class="line">unrar x file1.rar       ####解压rar包####</span><br><span class="line">tar -cvf archive.tar file1       ####创建一个非压缩的 tarball####</span><br><span class="line">tar -cvf archive.tar file1 file2 dir1       ####创建一个包含了 ‘file1′, ‘file2′ 以及 ‘dir1′的档案文件####</span><br><span class="line">tar -tf archive.tar       ####显示一个包中的内容####</span><br><span class="line">tar -xvf archive.tar       ####释放一个包####</span><br><span class="line">tar -xvf archive.tar -C /tmp       ####将压缩包释放到 /tmp目录下####</span><br><span class="line">tar -cvfj archive.tar.bz2 dir1       ####创建一个bzip2格式的压缩包####</span><br><span class="line">tar -xvfj archive.tar.bz2       ####解压一个bzip2格式的压缩包####</span><br><span class="line">tar -cvfz archive.tar.gz dir1       ####创建一个gzip格式的压缩包####</span><br><span class="line">tar -xvfz archive.tar.gz       ####解压一个gzip格式的压缩包####</span><br><span class="line">zip file1.zip file1       ####创建一个zip格式的压缩包####</span><br><span class="line">zip -r file1.zip file1 file2 dir1       ####将几个文件和目录同时压缩成一个zip格式的压缩包####</span><br><span class="line">unzip file1.zip       ####解压一个zip格式压缩包####</span><br><span class="line">unzip -n test.zip -d /tmp          #####压缩文件text.zip在指定目录/tmp下解压缩，如果已有相同的文件存在，要求unzip命令不覆盖原先的文件。#####</span><br><span class="line">unzip -o test.zip -d /tmp         ######将压缩文件test.zip在指定目录/tmp下解压缩，如果已有相同的文件存在，要求unzip命令覆盖原先的文件。#####</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/06/02/CentOS7%20&%20Docker%20Jenkins%E5%AE%89%E8%A3%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/06/02/CentOS7%20&%20Docker%20Jenkins%E5%AE%89%E8%A3%85/" class="post-title-link" itemprop="url">CentOS7 & Docker Jenkins安装</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-06-02 10:20:16" itemprop="dateCreated datePublished" datetime="2017-06-02T10:20:16+00:00">2017-06-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Jenkins/" itemprop="url" rel="index"><span itemprop="name">Jenkins</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CentOS7-jenkins配置-Net-Core持续部署"><a href="#CentOS7-jenkins配置-Net-Core持续部署" class="headerlink" title="CentOS7 jenkins配置.Net Core持续部署"></a>CentOS7 jenkins配置.Net Core持续部署</h1><h2 id="jenkins安装"><a href="#jenkins安装" class="headerlink" title="jenkins安装"></a>jenkins安装</h2><p><a target="_blank" rel="noopener" href="https://jenkins.io/download/" title="jenkins官网">Jenkins官网</a></p>
<h3 id="1-创建Dockerfile"><a href="#1-创建Dockerfile" class="headerlink" title="1.创建Dockerfile"></a>1.创建Dockerfile</h3><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用touch创建空文件</span></span><br><span class="line">sudo touch Dockerfile</span><br><span class="line">sudo vim Dockerfile</span><br></pre></td></tr></table></figure>

<h3 id="2-填充一下内容"><a href="#2-填充一下内容" class="headerlink" title="2.填充一下内容"></a>2.填充一下内容</h3><p>注：提前更新Docker镜像源</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> jenkins</span><br><span class="line"></span><br><span class="line"><span class="keyword">USER</span> root</span><br><span class="line"><span class="comment">#更新源并安装缺少的包</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get update &amp;&amp; apt-get install -y libltdl7 &amp;&amp; apt-get update</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使 jenkins 运行 docker 不需要 sudo</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> groupadd -o -g 999 docker &amp;&amp; usermod -aG docker jenkins</span></span><br><span class="line"><span class="keyword">ARG</span> dockerGid=<span class="number">999</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&quot;docker:x:<span class="variable">$&#123;dockerGid&#125;</span>:jenkins&quot;</span> &gt;&gt; /etc/group</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解决Docker时区问题</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> /bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; <span class="built_in">echo</span> <span class="string">&#x27;Asia/Shanghai&#x27;</span> &gt;/etc/timezone</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">USER</span> jenkins</span><br><span class="line"><span class="comment"># 解决时区问题</span></span><br><span class="line"><span class="keyword">ENV</span> JAVA_OPTS -Duser.timezone=Asia/Shanghai</span><br><span class="line"></span><br><span class="line"><span class="keyword">USER</span> root</span><br><span class="line"><span class="comment"># 安装 docker-compose 因为等下构建环境的需要</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> curl -L https://github.com/docker/compose/releases/download/1.21.1/docker-compose-`uname -s`-`uname -m` -o /usr/<span class="built_in">local</span>/bin/docker-compose</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span></span><br></pre></td></tr></table></figure>

<p>注：可能出现</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost Desktop]<span class="comment"># curl -L https://github.com/docker/compose/releases/download/1.16.1/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose</span></span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">  <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span> --:--:-- --:--:-- --:--:--     <span class="number">0</span></span><br><span class="line">curl: (<span class="number">35</span>) Peer reports incompatible or unsupported protocol version.</span><br></pre></td></tr></table></figure>

<p>需要运行以下命令更新：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum update nss curl nss-util nspr</span><br></pre></td></tr></table></figure>

<p>等待时间可能有点长，请耐心等待</p>
<p>运行结果：</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost Desktop]<span class="comment"># docker build . -t auto-jenkins</span></span><br><span class="line">Sending build context to Docker daemon   <span class="number">2.56</span>kB</span><br><span class="line">Step <span class="number">1</span>/<span class="number">8</span> : <span class="keyword">FROM</span> jenkins</span><br><span class="line"> ---&gt; <span class="number">7</span>b210b6c238a</span><br><span class="line">Step <span class="number">2</span>/<span class="number">8</span> : <span class="keyword">USER</span> root</span><br><span class="line"> ---&gt; Using cache</span><br><span class="line"> ---&gt; <span class="number">9</span>ce15bde1415</span><br><span class="line">Step <span class="number">3</span>/<span class="number">8</span> : <span class="keyword">RUN</span><span class="bash"> apt-get update &amp;&amp; apt-get install -y libltdl7 &amp;&amp; apt-get update</span></span><br><span class="line"> ---&gt; Using cache</span><br><span class="line"> ---&gt; <span class="number">3</span>d428282a736</span><br><span class="line">Step <span class="number">4</span>/<span class="number">8</span> : <span class="keyword">RUN</span><span class="bash"> groupadd -o -g 999 docker &amp;&amp; usermod -aG docker jenkins</span></span><br><span class="line"> ---&gt; Using cache</span><br><span class="line"> ---&gt; <span class="number">94</span>f6440d5fae</span><br><span class="line">Step <span class="number">5</span>/<span class="number">8</span> : <span class="keyword">ARG</span> dockerGid=<span class="number">999</span></span><br><span class="line"> ---&gt; Using cache</span><br><span class="line"> ---&gt; <span class="number">3</span>cce8ba121fe</span><br><span class="line">Step <span class="number">6</span>/<span class="number">8</span> : <span class="keyword">RUN</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&quot;docker:x:<span class="variable">$&#123;dockerGid&#125;</span>:jenkins&quot;</span> &gt;&gt; /etc/group</span></span><br><span class="line"> ---&gt; Using cache</span><br><span class="line"> ---&gt; a0f4fdd6cf3f</span><br><span class="line">Step <span class="number">7</span>/<span class="number">8</span> : <span class="keyword">RUN</span><span class="bash"> curl -L https://github.com/docker/compose/releases/download/1.21.1/docker-compose-`uname -s`-`uname -m` -o /usr/<span class="built_in">local</span>/bin/docker-compose</span></span><br><span class="line"> ---&gt; Running in fcdb1deaf0bf</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line"><span class="number">100</span>   <span class="number">617</span>    <span class="number">0</span>   <span class="number">617</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">226</span>      <span class="number">0</span> --:--:--  <span class="number">0</span>:<span class="number">00</span>:<span class="number">02</span> --:--:--   <span class="number">226</span></span><br><span class="line"><span class="number">100</span> <span class="number">10.3</span>M  <span class="number">100</span> <span class="number">10.3</span>M    <span class="number">0</span>     <span class="number">0</span>   <span class="number">591</span>k      <span class="number">0</span>  <span class="number">0</span>:<span class="number">00</span>:<span class="number">17</span>  <span class="number">0</span>:<span class="number">00</span>:<span class="number">17</span> --:--:-- <span class="number">1622</span>k</span><br><span class="line">Removing intermediate container fcdb1deaf0bf</span><br><span class="line"> ---&gt; <span class="number">1909</span>e02c39da</span><br><span class="line">Step <span class="number">8</span>/<span class="number">8</span> : <span class="keyword">RUN</span><span class="bash"> chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span></span><br><span class="line"> ---&gt; Running in <span class="number">409184886</span>de5</span><br><span class="line">Removing intermediate container <span class="number">409184886</span>de5</span><br><span class="line"> ---&gt; b0f1c2c53301</span><br><span class="line">Successfully built b0f1c2c53301</span><br><span class="line">Successfully tagged auto-jenkins:latest</span><br></pre></td></tr></table></figure>

<p>出现以上 Successfully 内容代表安装Jenkins成功</p>
<h2 id="启动Jenkins"><a href="#启动Jenkins" class="headerlink" title="启动Jenkins"></a>启动Jenkins</h2><p>需要先创建一个Jenkins的配置目录，并且挂载到docker 里的Jenkins目录下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /var/jenkins_home</span><br></pre></td></tr></table></figure>

<p>运行</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="bash"> --name jenkins -p 8080:8080 -p 50000:50000 \</span></span><br><span class="line"><span class="bash">    -v /var/run/docker.sock:/var/run/docker.sock \</span></span><br><span class="line"><span class="bash">    -v $(<span class="built_in">which</span> docker):/bin/docker \</span></span><br><span class="line"><span class="bash">    -v /var/jenkins_home:/var/jenkins_home \</span></span><br><span class="line"><span class="bash">    -d auto-jenkins</span></span><br></pre></td></tr></table></figure>

<p>第一行构建一个名称为jenkins的容器,需要使用的 8080 跟 50000 端口,-p 是容器运行开放端口</p>
<p>第二行将宿主机上的 docker.sock 挂载到容器中的相应位置，使得容器中的 docker cli 能跟宿主机的 docker 通信</p>
<p>第三行将宿主机上面的 docker 命令行工具挂载到容器中，使 jenkins 用户能够执行 docker 命令</p>
<p>第四行挂载我们之前创建的配置文件存放目录到 jenkins 用户的 home（对的，jenkins 用户的 home 目录在 /var 下面）,建立宿主机的配置目录，挂载进docker容器里，这样容器里的Jenkins配置目录文件就会映射出来</p>
<p>第五行：使用auto-jenkins Image 并且后台启动</p>
<p>运行完这条指令后，出现一串很长的字符串以后，我们的jenkins已经成功启动，可以访问本机的 8080 端口来登录 Jenkins</p>
<p>通过命令<code>docker ps</code>查看运行的镜像</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost Desktop]<span class="comment"># docker ps</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                                              NAMES</span><br><span class="line"><span class="number">0</span>c63f3ce79b5        auto-jenkins        <span class="string">&quot;/bin/tini -- /usr/l…&quot;</span>   <span class="number">12</span> seconds ago      Up <span class="number">5</span> seconds        <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">8080</span>-&gt;<span class="number">8080</span>/tcp, <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">50000</span>-&gt;<span class="number">50000</span>/tcp   jenkins</span><br></pre></td></tr></table></figure>

<p>删除docker</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm -f jenkins</span><br></pre></td></tr></table></figure>

<h2 id="配置jenkins"><a href="#配置jenkins" class="headerlink" title="配置jenkins"></a>配置jenkins</h2><p>进入容器内</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it jenkins /bin/bash</span><br></pre></td></tr></table></figure>

<p>查看密码：</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/jenkins_home/secrets/initialAdminPassword</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">oot@localhost Desktop]# docker exec -it jenkins /bin/bash</span><br><span class="line">root@0c63f3ce79b5:/# cat /var/jenkins_home/secrets/initialAdminPassword</span><br><span class="line">fc648ef222a54ac690bec031834885f2</span><br><span class="line">root@0c63f3ce79b5:/# exit</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>

<p>复制输出的内容，粘贴到Administrator password，输入 exit 退出容器，此时进行下一步你会看到此界面，点击 Install suggested plugins</p>
<p>重启：</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart jenkins</span><br></pre></td></tr></table></figure>

<p>最后，安装推荐插件</p>
<p>忘记管理员密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost Desktop]# cd /var/jenkins_home/users/admin/</span><br><span class="line">[root@localhost admin]# ls</span><br><span class="line">config.xml</span><br><span class="line">[root@localhost admin]# vim config.xml</span><br><span class="line">[root@localhost admin]# docker restart jenkins</span><br><span class="line">jenkins</span><br><span class="line">[root@localhost admin]#</span><br></pre></td></tr></table></figure>

<p>把<code>&lt;passwordHash&gt;</code>节点的内容（图中黑色的那一串）换成</p>
<p><code>#jbcrypt:$2a$10$DdaWzN64JgUtLdvxWIflcuQu2fgrrMSAMabF5TSrGK5nXitqK9ZMS</code></p>
<p>重启，默认密码为：111111</p>
<p>参考网址：</p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/LongJiangXie/p/7517909.html">http://www.cnblogs.com/LongJiangXie/p/7517909.html</a></p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/stulzq/p/8627360.html">http://www.cnblogs.com/stulzq/p/8627360.html</a></p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/JacZhu/p/6814848.html">http://www.cnblogs.com/JacZhu/p/6814848.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/05/31/zookeeper%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE%EF%BC%88%E5%8D%95%E6%9C%BA%E5%92%8C%E9%9B%86%E7%BE%A4%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/31/zookeeper%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE%EF%BC%88%E5%8D%95%E6%9C%BA%E5%92%8C%E9%9B%86%E7%BE%A4%EF%BC%89/" class="post-title-link" itemprop="url">zookeeper的安装与配置（单机和集群）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-31 10:05:13" itemprop="dateCreated datePublished" datetime="2017-05-31T10:05:13+00:00">2017-05-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/zookeeper/" itemprop="url" rel="index"><span itemprop="name">zookeeper</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="zookeeper的安装与配置（单机和集群）"><a href="#zookeeper的安装与配置（单机和集群）" class="headerlink" title="zookeeper的安装与配置（单机和集群）"></a>zookeeper的安装与配置（单机和集群）</h1><h2 id="单机安装"><a href="#单机安装" class="headerlink" title="单机安装"></a>单机安装</h2><p>1、首先去官网下载zookeeper的包 <a target="_blank" rel="noopener" href="http://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/" title="下载">zookeeper-3.4.10.tar.gz</a></p>
<p>2、用FTP文上传到/usr/local下</p>
<p>3、解压文件 <code>tar -zxvf zookeeper-3.4.10.tar.gz</code></p>
<p>4、在conf文件夹下新建zoo.cfg文件，或者使用里面自带的zoo_sample.cfg，重新拷贝</p>
<p><code>cp zoo_sample.cfg  zoo.cfg</code></p>
<p>zoo.cfg文件内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">dataDir=/usr/local/zookeeper/zookeeper-3.4.10/data</span><br><span class="line">dataLogDir=/usr/local/zookeeper/zookeeper-3.4.10/logs</span><br><span class="line">clientPort=4180</span><br></pre></td></tr></table></figure>

<p>5、运行server脚本</p>
<p>需要在root账户下启动：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost zookeeper-3.4.10]# ./bin/zkServer.sh start</span><br></pre></td></tr></table></figure>

<p>6、Server启动之后, 就可以启动client连接server了, 执行脚本:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost zookeeper-3.4.10]# ./bin/zkCli.sh -server localhost:4180</span><br></pre></td></tr></table></figure>

<p>7，检查状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost zookeeper-3.4.10]# ./bin/zkServer.sh start</span><br></pre></td></tr></table></figure>

<p>8，停止</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost zookeeper-3.4.10]# ./bin/zkServer.sh stop</span><br></pre></td></tr></table></figure>

<h2 id="伪集群模式"><a href="#伪集群模式" class="headerlink" title="伪集群模式"></a>伪集群模式</h2><p>所谓伪集群, 是指在单台机器中启动多个zookeeper进程, 并组成一个集群. 以启动3个zookeeper进程为例</p>
<ul>
<li>复制三份zookeeper,(权限需要使用root帐号)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[toor@localhost zookeeper]$ su root</span><br><span class="line">Password:</span><br><span class="line">[root@localhost zookeeper]# cp -r zookeeper-3.4.10 zookeeper-3.4.10-1</span><br><span class="line">[root@localhost zookeeper]# cp -r zookeeper-3.4.10 zookeeper-3.4.10-2</span><br><span class="line">[root@localhost zookeeper]# cp -r zookeeper-3.4.10 zookeeper-3.4.10-3</span><br></pre></td></tr></table></figure>

<ul>
<li>配置每个zookeeper文件夹中对应的配置文件</li>
</ul>
<p>1，zookeeper-3.4.10-1中的zoo.cfg文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">initLimit=5</span><br><span class="line">syncLimit=2</span><br><span class="line">tickTime=2000</span><br><span class="line">dataDir=/usr/local/zookeeper/zookeeper-3.4.10-1/data</span><br><span class="line">dataLogDir=/usr/local/zookeeper/zookeeper-3.4.10-1/logs</span><br><span class="line">clientPort=4180</span><br><span class="line">server.0=127.0.0.1:8880:7770</span><br><span class="line">server.1=127.0.0.1:8881:7771</span><br><span class="line">server.2=127.0.0.1:8882:7772</span><br></pre></td></tr></table></figure>

<p>2，zookeeper-3.4.10-2中的zoo.cfg文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">initLimit=5</span><br><span class="line">syncLimit=2</span><br><span class="line">tickTime=2000</span><br><span class="line">dataDir=/usr/local/zookeeper/zookeeper-3.4.10-2/data</span><br><span class="line">dataLogDir=/usr/local/zookeeper/zookeeper-3.4.10-2/logs</span><br><span class="line">clientPort=4180</span><br><span class="line">server.0=127.0.0.1:8880:7770</span><br><span class="line">server.1=127.0.0.1:8881:7771</span><br><span class="line">server.2=127.0.0.1:8882:7772</span><br></pre></td></tr></table></figure>

<p>3，zookeeper-3.4.10-3中的zoo.cfg文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">initLimit=5</span><br><span class="line">syncLimit=2</span><br><span class="line">tickTime=2000</span><br><span class="line">dataDir=/usr/local/zookeeper/zookeeper-3.4.10-3/data</span><br><span class="line">dataLogDir=/usr/local/zookeeper/zookeeper-3.4.10-3/logs</span><br><span class="line">clientPort=4180</span><br><span class="line">server.0=127.0.0.1:8880:7770</span><br><span class="line">server.1=127.0.0.1:8881:7771</span><br><span class="line">server.2=127.0.0.1:8882:7772</span><br></pre></td></tr></table></figure>

<p>发现只有dataDir和dataLogDir还有clientPort这三个参数不一致，其他参数完全一致。</p>
<ul>
<li><p>配置myid</p>
<p>  在这三个datadir配置的路径下/Users/zookeeper0、1、2上增加myid文件，里面依次填上0、1、2。</p>
<p>  数字0、1、2和每个conf/zoo.cfg中的server.0、server.1、server.2的数字一一对应，让zookeeper知道你是哪个server</p>
</li>
<li><p>依次启动zookeeper节点服务</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/zkServer.sh start</span><br></pre></td></tr></table></figure>

<p>检查状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/zkServer.sh status</span><br></pre></td></tr></table></figure>

<p>客户端连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/zkCli.sh -server localhost:4180</span><br></pre></td></tr></table></figure>

<p>看到输出显示有下列信息，表示启动，配置成功！</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Welcome to ZooKeeper!</span><br></pre></td></tr></table></figure>

<h2 id="集群模式"><a href="#集群模式" class="headerlink" title="集群模式"></a>集群模式</h2><p>集群模式, 各server部署在不同的机器上, 因此各server的conf/zoo.cfg文件可以完全一样（是所有都一样）</p>
<p>他们的zookeeper的conf下的zoo.cfg文件为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">initLimit=5</span><br><span class="line">syncLimit=2</span><br><span class="line">dataDir=/home/zookeeper/data</span><br><span class="line">dataLogDir=/home/zookeeper/logs</span><br><span class="line">clientPort=4180</span><br><span class="line">server.1=192.168.1.130:2888:3888</span><br><span class="line">server.2=192.168.1.131:2888:3888</span><br><span class="line">server.3=192.168.1.132:2888:3888</span><br></pre></td></tr></table></figure>

<p>部署了3台zookeeper server, 分别部署在192.168.1.130, 192.168.1.131, 192.168.1.132上。</p>
<p>各server的dataDir目录下的myid文件中的数字必须不同。</p>
<p>　　192.168.1.130 server的myid为1</p>
<p>　　192.168.1.131 server的myid为2</p>
<p>　　192.168.1.132 server的myid为3</p>
<p>至此，所有的安装与部署就都搞定了。</p>
<h2 id="ZooKeeper服务命令"><a href="#ZooKeeper服务命令" class="headerlink" title="ZooKeeper服务命令:"></a>ZooKeeper服务命令:</h2><p>在准备好相应的配置之后，可以直接通过zkServer.sh 这个脚本进行服务的相关操作</p>
<ol>
<li>启动ZK服务:       sh bin/zkServer.sh start</li>
<li>查看ZK服务状态: sh bin/zkServer.sh status</li>
<li>停止ZK服务:       sh bin/zkServer.sh stop</li>
<li>重启ZK服务:       sh bin/zkServer.sh restart</li>
</ol>
<p>zoo.cfg配置详解：</p>
<p>tickTime：Zookeeper 服务器之间或客户端与服务器之间维持心跳的时间间隔，每个tickTime 时间就会发送一个心跳。</p>
<p>dataDir：Zookeeper 保存数据的目录，默认情况下，Zookeeper 将写数据的日志文件也保存在这个目录里。</p>
<p>clientPort：客户端连接 Zookeeper 服务器的端口，Zookeeper 会监听这个端口，接受客户端的访问请求。</p>
<p>initLimit：Leader和Follower初始化连接时最长能忍受多少个心跳时间间隔数。总的时间长度就是 5*2000=10 秒。</p>
<p>syncLimit：Leader 与 Follower之间发送消息，最长不能超过多少个 tickTime 的时间长度，总的时间长度就是 2*2000=4 秒。</p>
<p>server.A=B：C：D：其中 A 是一个数字，表示这个是第几号服务器；B 是这个服务器的 ip 地址；C 表示的是这个服务器与集群中的 Leader 服务器交换信息的端口；D 表示的是万一集群中的 Leader 服务器挂了，需要一个端口来重新进行选举，选出一个新的 Leader，而这个端口就是用来执行选举时服务器相互通信的端口。如果是伪集群的配置方式，由于 B 都是一样，所以不同的 Zookeeper 实例通信端口号不能一样，所以要给它们分配不同的端口号。</p>
<p>myid文件:</p>
<p>除了修改 zoo.cfg 配置文件，集群模式下还要配置一个文件 myid，这个文件在 dataDir 目录下，这个文件里面就有一个数据就是 A 的值，Zookeeper 启动时会读取这个文件，拿到里面的数据与 zoo.cfg 里面的配置信息比较从而判断到底是哪个server。</p>
<p>server.1=10.1.39.43:2888:3888，很多人不理解为啥后面有两个端口？解释一下：</p>
<p>2888：标识这个服务器与集群中的leader服务器交换信息的端口 </p>
<p>3888：leader挂掉时专门用来进行选举leader所用的端口</p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/hzg110/p/6921886.html" title="参考链接">http://www.cnblogs.com/hzg110/p/6921886.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/05/27/%E4%BD%BF%E7%94%A8Apache%20Benchmark%E8%BF%9B%E8%A1%8C%E7%AB%99%E7%82%B9%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/27/%E4%BD%BF%E7%94%A8Apache%20Benchmark%E8%BF%9B%E8%A1%8C%E7%AB%99%E7%82%B9%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/" class="post-title-link" itemprop="url">使用Apache Benchmark进行站点压力测试</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-27 11:11:18" itemprop="dateCreated datePublished" datetime="2017-05-27T11:11:18+00:00">2017-05-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Apache-Benchmark/" itemprop="url" rel="index"><span itemprop="name">Apache Benchmark</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="使用ab进行站点压力测试"><a href="#使用ab进行站点压力测试" class="headerlink" title="使用ab进行站点压力测试"></a>使用ab进行站点压力测试</h1><h2 id="压力测试相关概念"><a href="#压力测试相关概念" class="headerlink" title="压力测试相关概念"></a>压力测试相关概念</h2><ul>
<li><p>吞吐率（Requests per second）</p>
<p>  概念：服务器并发处理能力的量化描述，单位是reqs/s，指的是某个并发用户数下单位时间内处理的请求数。某个并发用户数下单位时间内能处理的最大请求数，称之为最大吞吐率。<br>  计算公式：总请求数 / 处理完成这些请求数所花费的时间，即<br>  Request per second = Complete requests / Time taken for tests</p>
</li>
<li><p>并发连接数（The number of concurrent connections）</p>
<p>  概念：某个时刻服务器所接受的请求数目，简单的讲，就是一个会话。</p>
<p>  并发用户数（The number of concurrent users，Concurrency Level）</p>
<p>  概念：要注意区分这个概念和并发连接数之间的区别，一个用户可能同时会产生多个会话，也即连接数。</p>
</li>
<li><p>用户平均请求等待时间（Time per request）</p>
<p>  计算公式：处理完成所有请求数所花费的时间/ （总请求数 / 并发用户数），即<br>  Time per request = Time taken for tests /（ Complete requests / Concurrency Level）</p>
</li>
<li><p>服务器平均请求等待时间（Time per request: across all concurrent requests）</p>
<p>  计算公式：处理完成所有请求数所花费的时间 / 总请求数，即<br>  Time taken for / testsComplete requests<br>  可以看到，它是吞吐率的倒数。<br>  同时，它也=用户平均请求等待时间/并发用户数，即<br>  Time per request / Concurrency Level</p>
</li>
</ul>
<h3 id="下载工具"><a href="#下载工具" class="headerlink" title="下载工具"></a>下载工具</h3><p><a target="_blank" rel="noopener" href="https://www.apachelounge.com/download/" title="下载链接">官网下载网址</a> </p>
<p>解压压缩包，进入到<code>httpd-2.4.25-win64-VC14\Apache24\bin</code>目录下，<br>打开命令行，输入命令</p>
<h3 id="运行测试"><a href="#运行测试" class="headerlink" title="运行测试"></a>运行测试</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ab -n 100 -c 10 http://baidu.com/</span><br></pre></td></tr></table></figure>

<p>其中－n表示请求数，－c表示并发数</p>
<h3 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h3><p><img src="/img/ab%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png" alt="测试结果"></p>
<h3 id="完整测试报告"><a href="#完整测试报告" class="headerlink" title="完整测试报告"></a>完整测试报告</h3><h4 id="服务器信息"><a href="#服务器信息" class="headerlink" title="服务器信息"></a>服务器信息</h4><pre><code>显示服务器为apache,域名，端口；</code></pre><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Server Software:        Apache</span><br><span class="line">Server Hostname:        baidu.com</span><br><span class="line">Server Port:            80</span><br></pre></td></tr></table></figure>

<h4 id="文档信息"><a href="#文档信息" class="headerlink" title="文档信息"></a>文档信息</h4><pre><code>所在位置“/”，文档的大小为338436 bytes（此为http响应的正文长度）</code></pre><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Document Path:          /</span><br><span class="line">Document Length:        81 bytes</span><br></pre></td></tr></table></figure>

<h4 id="重要信息"><a href="#重要信息" class="headerlink" title="重要信息"></a>重要信息</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Concurrency Level:      10</span><br><span class="line">Time taken for tests:   2.584 seconds</span><br><span class="line">Complete requests:      100</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      38100 bytes</span><br><span class="line">HTML transferred:       8100 bytes</span><br><span class="line">Requests per second:    38.70 [#/sec] (mean)</span><br><span class="line">Time per request:       258.374 [ms] (mean)</span><br><span class="line">Time per request:       25.837 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          14.40 [Kbytes/sec] received</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">//并发请求数</span><br><span class="line">Concurrency Level: 10</span><br><span class="line"></span><br><span class="line">//整个测试持续的时间</span><br><span class="line">Time taken for tests: 2.584 seconds</span><br><span class="line"></span><br><span class="line">//完成的请求数</span><br><span class="line">Complete requests: 100</span><br><span class="line"></span><br><span class="line">//失败的请求数</span><br><span class="line">Failed requests: 0</span><br><span class="line"></span><br><span class="line">//整个场景中的网络传输量</span><br><span class="line">Total transferred: 13701482 bytes</span><br><span class="line"></span><br><span class="line">//整个场景中的HTML内容传输量</span><br><span class="line">HTML transferred: 13197000 bytes</span><br><span class="line"></span><br><span class="line">//吞吐率，大家最关心的指标之一，相当于 LR 中的每秒事务数，后面括号中的 mean 表示这是一个平均值</span><br><span class="line">Requests per second: 38.70 [#/sec] (mean)</span><br><span class="line"></span><br><span class="line">//用户平均请求等待时间，大家最关心的指标之二，相当于 LR 中的平均事务响应时间，后面括号中的 mean 表示这是一个平均值</span><br><span class="line">Time per request: 258.374 [ms] (mean)</span><br><span class="line"></span><br><span class="line">//服务器平均请求处理时间，大家最关心的指标之三</span><br><span class="line">Time per request: 25.837 [ms] (mean, across all concurrent requests)</span><br><span class="line"></span><br><span class="line">//平均每秒网络上的流量，可以帮助排除是否存在网络流量过大导致响应时间延长的问题</span><br><span class="line">Transfer rate: 14.40 [Kbytes/sec] received</span><br></pre></td></tr></table></figure>

<h4 id="网络上消耗的时间的分解"><a href="#网络上消耗的时间的分解" class="headerlink" title="网络上消耗的时间的分解"></a>网络上消耗的时间的分解</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:       12   25  38.9     20     408</span><br><span class="line">Processing:     8  223 120.3    196     591</span><br><span class="line">Waiting:        8  142 124.9    120     574</span><br><span class="line">Total:         29  248 125.7    217     609</span><br></pre></td></tr></table></figure>

<h4 id="网络消耗时间"><a href="#网络消耗时间" class="headerlink" title="网络消耗时间"></a>网络消耗时间</h4><p>这段是每个请求处理时间的分布情况，50%的处理时间在217ms内，66%的处理时间在224ms内…，重要的是看90%的处理时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line">  50%    217</span><br><span class="line">  66%    224</span><br><span class="line">  75%    246</span><br><span class="line">  80%    249</span><br><span class="line">  90%    595</span><br><span class="line">  95%    604</span><br><span class="line">  98%    609</span><br><span class="line">  99%    609</span><br><span class="line"> 100%    609 (longest request)</span><br></pre></td></tr></table></figure>

<h4 id="登录的问题"><a href="#登录的问题" class="headerlink" title="登录的问题"></a>登录的问题</h4><pre><code>有时候进行压力测试需要用户登录，怎么办？
请参考以下步骤：

先用账户和密码登录后，用开发者工具找到标识这个会话的Cookie值（Session ID）记下来
如果只用到一个Cookie，那么只需键入命令：
ab －n 100 －C key＝value http://baidu.com/

如果需要多个Cookie，就直接设Header：
ab -n 100 -H “Cookie: Key1=Value1; Key2=Value2” http://baidu.com/

同类型的压力测试工具还有：webbench、siege、http_load等</code></pre><p>参考：</p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/lpfuture/p/5740831.html" title="参考1">http://www.cnblogs.com/lpfuture/p/5740831.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/05/25/win10%E5%AE%89%E8%A3%85openssl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/25/win10%E5%AE%89%E8%A3%85openssl/" class="post-title-link" itemprop="url">win10安装openssl</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-25 15:32:39" itemprop="dateCreated datePublished" datetime="2017-05-25T15:32:39+00:00">2017-05-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Openssl/" itemprop="url" rel="index"><span itemprop="name">Openssl</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="win10安装openssl"><a href="#win10安装openssl" class="headerlink" title="win10安装openssl"></a>win10安装openssl</h1><h2 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h2><p>openssl官网：<a target="_blank" rel="noopener" href="https://www.openssl.org/" title="openssl官网">https://www.openssl.org/</a></p>
<p>openssl下载地址：<a target="_blank" rel="noopener" href="http://slproweb.com/products/Win32OpenSSL.html" title="openssl下载地址">http://slproweb.com/products/Win32OpenSSL.html</a></p>
<p>下载<code>Win64 OpenSSL v1.1.0e</code>(win10 64位)，点击依次点击下一步，即可完成安装；</p>
<h2 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h2><p>找到“系统-&gt;高级系统设置-&gt;环境变量”窗口里面的系统变量；</p>
<p>添加变量名为“OPENSSL_HOME”，变量值：“C:\OpenSSL-Win64\bin”（根据本机openssl安装目录配置），然后在变量名为“Path”中添加“%OPENSSL_HOME%”</p>
<p>如图：</p>
<p><img src="/img/openssl%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE1.png" alt="配置1"></p>
<p><img src="/img/openssl%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE2.png" alt="配置2"></p>
<p>注意：设置完环境变量后的cmd窗口必须重新打开，设置的环境变量才会起作用，否则依然提示命令不可用。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/05/24/%E4%BD%BF%E7%94%A8WinSCP%E8%BD%AF%E4%BB%B6%E5%9C%A8windows%E5%92%8CLinux%E4%B8%AD%E8%BF%9B%E8%A1%8C%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/24/%E4%BD%BF%E7%94%A8WinSCP%E8%BD%AF%E4%BB%B6%E5%9C%A8windows%E5%92%8CLinux%E4%B8%AD%E8%BF%9B%E8%A1%8C%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93/" class="post-title-link" itemprop="url">使用WinSCP软件在windows和Linux中进行文件传输</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-24 14:24:14" itemprop="dateCreated datePublished" datetime="2017-05-24T14:24:14+00:00">2017-05-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WinSCP/" itemprop="url" rel="index"><span itemprop="name">WinSCP</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="使用WinSCP软件在windows和Linux中进行文件传输"><a href="#使用WinSCP软件在windows和Linux中进行文件传输" class="headerlink" title="使用WinSCP软件在windows和Linux中进行文件传输"></a>使用WinSCP软件在windows和Linux中进行文件传输</h1><p>官方的解释：WinSCP 是一个 Windows 环境下使用 SSH 的开源图形化 SFTP 客户端。同时支持 SCP 协议。它的主要功能就是在本地与远程计算机间安全的复制文件等。</p>
<p>官网网站：<a target="_blank" rel="noopener" href="http://winscp.net/eng/docs/lang:chs" title="官网">http://winscp.net/eng/docs/lang:chs</a></p>
<p>下载地址：<a target="_blank" rel="noopener" href="http://winscp.net/eng/download.php" title="下载">http://winscp.net/eng/download.php</a></p>
<p>Portable executables是绿色版，不需要安装。<br>下载完成之后打开可执行文件，填写登录信息，选择协议之后，就可以进行图形化管理了。</p>
<p><img src="/img/winscp-%E9%85%8D%E7%BD%AE.png" alt="配置"></p>
<p>我们只需要填写3个地方：1. host name 2.user name 3.password。hostname是虚拟机的IP地址。<br>最好是填写root用户时的用户名和密码。点击登陆就进入到Linux系统了<br>界面中，左边属于windows操作系统的目录，右边属于Linux（CentOS）操作系统的目录。可以用鼠标直接把文件拖过来拖过去的。</p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/shanyou/archive/2012/08/25/2656753.html" title="winscp配置">http://www.cnblogs.com/shanyou/archive/2012/08/25/2656753.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/05/24/CentOS7%E4%BD%BF%E7%94%A8Jexus%E9%83%A8%E7%BD%B2DotNetCore%E5%BA%94%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/24/CentOS7%E4%BD%BF%E7%94%A8Jexus%E9%83%A8%E7%BD%B2DotNetCore%E5%BA%94%E7%94%A8/" class="post-title-link" itemprop="url">CentOS7使用Jexus部署.NetCore应用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-24 13:57:28" itemprop="dateCreated datePublished" datetime="2017-05-24T13:57:28+00:00">2017-05-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Jexus/" itemprop="url" rel="index"><span itemprop="name">Jexus</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CentOS7使用Jexus部署-NetCore应用"><a href="#CentOS7使用Jexus部署-NetCore应用" class="headerlink" title="CentOS7使用Jexus部署.NetCore应用"></a>CentOS7使用Jexus部署.NetCore应用</h1><h2 id="安装Jexus"><a href="#安装Jexus" class="headerlink" title="安装Jexus"></a>安装Jexus</h2><p>安装 Jexus 直接使用一下命令即可(需要在root身份下执行):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://jexus.org/release/x64/install.sh|sh</span><br></pre></td></tr></table></figure>

<p>安装成功后会提示：OK, Jexus has been installed in /usr/jexus.</p>
<h2 id="发布程序到CentOS7服务器"><a href="#发布程序到CentOS7服务器" class="headerlink" title="发布程序到CentOS7服务器"></a>发布程序到CentOS7服务器</h2><p>在<code>/usr/local</code>建立www文件夹，将应用程序包放在www文件夹下</p>
<p>如果www不存在，则使用命令创建：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/local/www</span><br></pre></td></tr></table></figure>

<p>将发布好的程序，拷贝到linux系统/usr/local/www文件夹中</p>
<p>参考使用</p>
<p><a target="_blank" rel="noopener" href="https://syxdevcode.github.io/2017/05/24/%E4%BD%BF%E7%94%A8WinSCP%E8%BD%AF%E4%BB%B6%E5%9C%A8windows%E5%92%8CLinux%E4%B8%AD%E8%BF%9B%E8%A1%8C%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93/" title="WinSCP">WinSCP配置</a></p>
<h2 id="配置Jexus"><a href="#配置Jexus" class="headerlink" title="配置Jexus"></a>配置Jexus</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/jexus/siteconf #切换到jexus配置文件目录</span><br><span class="line">cp default test #复制默认配置文件test</span><br><span class="line">vim test #编辑</span><br></pre></td></tr></table></figure>

<p>参考配置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">port=82  # 外部访问的端口号，可以改成你想要的端口号,外部访问通过 ip/域名:端口号 即可访问</span><br><span class="line">roott=/ /usr/local/www/SessionTest/ # 应用程序的工作根目录(全路径)</span><br><span class="line">hosts=*    #OR your.com,*.your.com  如果为服务器设置了DNS解析，则可以填写解析到服务器的域名，如:www.myweb.com</span><br><span class="line"></span><br><span class="line">AppHost=&#123;</span><br><span class="line">  cmd=dotnet SessionTest.dll; # 命令，启动Asp.Net Core应用要执行的命令</span><br><span class="line">  root=/usr/local/www/SessionTest/; # Asp.Net Core应用程序所在的全路径 </span><br><span class="line">  port=0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">port=0;</span><br><span class="line"># Asp.Net Core应用程序所使用的端口号，如果在程序中使用了UsrUrls自定义端口则使用UsrUrls中填写的端口</span><br><span class="line"></span><br><span class="line">(不建议使用UsrUrls自定义端口), 在没有使用UsrUrls自定义端口的情况下端口号设置为 0，Jexus会在运行时与</span><br><span class="line"></span><br><span class="line">Asp.Net Core进行&quot;协商&quot;具体使用的端口号，避免多个应用分配端口的麻烦和冲突的风险。</span><br></pre></td></tr></table></figure>

<p>反向代理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reproxy=/ http://192.168.1.132:5100,http://192.168.1.130:5100</span><br></pre></td></tr></table></figure>

<h2 id="启动-重启-Jexus"><a href="#启动-重启-Jexus" class="headerlink" title="启动/重启 Jexus"></a>启动/重启 Jexus</h2><p>当配置文件编辑完成后使用以下命令对Jexus进行 启动/重启</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 如果已启动 Jexus：</span><br><span class="line">sh /usr/jexus/jws restart</span><br><span class="line"></span><br><span class="line"># 如果未启动 Jexus：</span><br><span class="line">sh /usr/jexus/jws start</span><br></pre></td></tr></table></figure>

<h2 id="开启远程访问端口"><a href="#开启远程访问端口" class="headerlink" title="开启远程访问端口"></a>开启远程访问端口</h2><p>开放jexus配置的82端口，以供外部访问：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=82/tcp --permanent</span><br></pre></td></tr></table></figure>

<p>命令含义：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--zone #作用域</span><br><span class="line"></span><br><span class="line">--add-port=82/tcp #添加端口，格式为：端口/通讯协议</span><br><span class="line"></span><br><span class="line">--permanent #永久生效，没有此参数重启后失效</span><br><span class="line"></span><br><span class="line">firewall-cmd --reload  #重启防火墙</span><br></pre></td></tr></table></figure>

<p>参考：</p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/staneee/p/6852559.html" title="Jexus安装配置">http://www.cnblogs.com/staneee/p/6852559.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jexus.org/" title="Jexus官网">https://www.jexus.org/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.linuxdot.net/bbsfile-3084" title="Jexus官网文档">https://www.linuxdot.net/bbsfile-3084</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/05/18/CentOS7-Nginx%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/18/CentOS7-Nginx%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">CentOS7-Nginx安装配置</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-18 09:46:54" itemprop="dateCreated datePublished" datetime="2017-05-18T09:46:54+00:00">2017-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Nginx/" itemprop="url" rel="index"><span itemprop="name">Nginx</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Nginx安装"><a href="#Nginx安装" class="headerlink" title="Nginx安装"></a>Nginx安装</h2><h3 id="Yum安装方式"><a href="#Yum安装方式" class="headerlink" title="Yum安装方式"></a>Yum安装方式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# yum install epel-release</span><br><span class="line">[root@localhost /]# yum install nginx</span><br><span class="line">[root@localhost /]# systemctl start nginx #启动</span><br><span class="line">[root@localhost /]# systemctl enable nginx #可用</span><br><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/nginx.service to /usr/lib/systemd/system/nginx.service.</span><br></pre></td></tr></table></figure>

<p>将nginx 设置为启动系统自动启动nginx</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# echo &quot;/usr/local/nginx/sbin/nginx&quot; &gt;&gt; /etc/rc.local</span><br></pre></td></tr></table></figure>

<h3 id="nginx-conf配置文件"><a href="#nginx-conf配置文件" class="headerlink" title="nginx.conf配置文件"></a>nginx.conf配置文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]# cd /etc/nginx #定位到nginx安装目录</span><br><span class="line">[root@localhost nginx]# vim nginx.conf #通过vim打开nginx.conf配置文件进行配置</span><br></pre></td></tr></table></figure>

<p>在http节点中，添加配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#设定负载均衡的服务器列表</span><br><span class="line">upstream load_balance_server &#123;</span><br><span class="line">    #weigth参数表示权值，权值越高被分配到的几率越大</span><br><span class="line">    server 192.168.1.131:5100   weight=5;</span><br><span class="line">    server 192.168.1.132:5100   weight=1;</span><br><span class="line">    server 192.168.1.130:5100   weight=6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在http-&gt;server节点中添加配置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    root   html;</span><br><span class="line">    index  index.aspx index.html index.htm;</span><br><span class="line">    #其中load_balance_server 对应着upstream设置的集群名称</span><br><span class="line">    proxy_pass         http://load_balance_server;</span><br><span class="line">    #设置主机头和客户端真实地址，以便服务器获取客户端真实IP</span><br><span class="line">    proxy_set_header   Host             $host;</span><br><span class="line">    proxy_set_header   X-Real-IP        $remote_addr;</span><br><span class="line">    proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h4><p>nginx 启动失败</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost nginx]# service nginx restart</span><br><span class="line">Redirecting to /bin/systemctl restart  nginx.service</span><br><span class="line">Job for nginx.service failed because the control process exited with error code. See &quot;systemctl status nginx.service&quot; and &quot;journalctl -xe&quot; for details.</span><br><span class="line">[root@localhost nginx]# systemctl status nginx -l</span><br><span class="line">● nginx.service - The nginx HTTP and reverse proxy server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/nginx.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: failed (Result: exit-code) since Thu 2017-05-18 09:34:41 CST; 6s ago</span><br><span class="line">  Process: 121270 ExecStartPre=/usr/sbin/nginx -t (code=exited, status=1/FAILURE)</span><br><span class="line">  Process: 121265 ExecStartPre=/usr/bin/rm -f /run/nginx.pid (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 117382 (code=exited, status=0/SUCCESS)</span><br><span class="line"></span><br><span class="line">May 18 09:34:41 localhost.localdomain systemd[1]: Starting The nginx HTTP and reverse proxy server...</span><br><span class="line">May 18 09:34:41 localhost.localdomain nginx[121270]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok</span><br><span class="line">May 18 09:34:41 localhost.localdomain nginx[121270]: nginx: [emerg] bind() to 0.0.0.0:5100 failed (13: Permission denied)</span><br><span class="line">May 18 09:34:41 localhost.localdomain nginx[121270]: nginx: configuration file /etc/nginx/nginx.conf test failed</span><br><span class="line">May 18 09:34:41 localhost.localdomain systemd[1]: nginx.service: control process exited, code=exited status=1</span><br><span class="line">May 18 09:34:41 localhost.localdomain systemd[1]: Failed to start The nginx HTTP and reverse proxy server.</span><br><span class="line">May 18 09:34:41 localhost.localdomain systemd[1]: Unit nginx.service entered failed state.</span><br><span class="line">May 18 09:34:41 localhost.localdomain systemd[1]: nginx.service failed.</span><br></pre></td></tr></table></figure>

<p>权限拒绝，经检查发现是开启selinux 导致的。 直接关闭</p>
<p>getenforce   这个命令可以查看当前是否开启了selinux 如果输出 disabled 或 permissive 那就是关闭了</p>
<p>如果输出 enforcing 那就是开启了 selinux</p>
<p>1、临时关闭selinux</p>
<p>setenforce 0            ##设置SELinux 成为permissive模式</p>
<p>setenforce 1    ##设置SELinux 成为enforcing模式</p>
<p>2、永久关闭selinux,</p>
<p>修改/etc/selinux/config 文件</p>
<p>将SELINUX=enforcing改为SELINUX=disabled</p>
<p>重启机器即可</p>
<h3 id="重启nginx服务"><a href="#重启nginx服务" class="headerlink" title="重启nginx服务"></a>重启nginx服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service nginx restart</span><br></pre></td></tr></table></figure>

<p>参考：</p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/Andon_liu/p/5353522.html" title="Nginx安装">http://www.cnblogs.com/Andon_liu/p/5353522.html</a></p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/jingmoxukong/p/5945200.html" title="Nginx详细配置">http://www.cnblogs.com/jingmoxukong/p/5945200.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/05/16/CentOS7%E5%AE%89%E8%A3%85Redis-3.2.8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/16/CentOS7%E5%AE%89%E8%A3%85Redis-3.2.8/" class="post-title-link" itemprop="url">centos7安装Redis-3.2.8</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-16 16:22:36" itemprop="dateCreated datePublished" datetime="2017-05-16T16:22:36+00:00">2017-05-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Redis/" itemprop="url" rel="index"><span itemprop="name">Redis</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><a target="_blank" rel="noopener" href="https://redis.io/" title="官网">官网</a>下载</p>
<p>下载地址：<a target="_blank" rel="noopener" href="http://download.redis.io/releases/redis-3.2.8.tar.gz" title="redis-3.2.8.tar.gz">redis-3.2.8.tar.gz</a></p>
<h3 id="依赖包"><a href="#依赖包" class="headerlink" title="依赖包"></a>依赖包</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc</span><br></pre></td></tr></table></figure>

<h3 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-3.2.8.tar.gz # 获取包</span><br><span class="line">tar -zxvf redis-3.2.8.tar.gz</span><br><span class="line">cd redis-3.2.8</span><br><span class="line">cd src</span><br><span class="line">make distclean </span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>

<h3 id="移动文件夹"><a href="#移动文件夹" class="headerlink" title="移动文件夹"></a>移动文件夹</h3><p>移动文件，便于管理：(所有源代码安装的软件都安装在/usr/local下)</p>
<p>创建两个文件夹，bin用于存放命令，etc拥有存放配置文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/local/redis/etc</span><br><span class="line">mkdir -p /usr/local/redis/bin</span><br></pre></td></tr></table></figure>

<p>-p是递归创建。</p>
<p>接下来，将redis-3.2.8文件夹下的redis.conf复制到/usr/local/redis/etc/</p>
<p>并将src目录下的6个命令文件（绿色的），移动到/usr/local/redis/bin/</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost src]# mkdir -p /usr/local/redis/etc</span><br><span class="line">[root@localhost src]# mkdir -p /usr/local/redis/bin</span><br><span class="line">[root@localhost src]# cd ..</span><br><span class="line">[root@localhost redis-3.2.8]# ls</span><br><span class="line">00-RELEASENOTES  COPYING  Makefile   redis.conf       runtest-sentinel  tests</span><br><span class="line">BUGS             deps     MANIFESTO  runtest          sentinel.conf     utils</span><br><span class="line">CONTRIBUTING     INSTALL  README.md  runtest-cluster  src</span><br><span class="line">[root@localhost redis-3.2.8]# mv ./redis.conf /usr/local/redis/etc</span><br><span class="line">[root@localhost redis-3.2.8]# ls</span><br><span class="line">00-RELEASENOTES  COPYING  Makefile   runtest           sentinel.conf  utils</span><br><span class="line">BUGS             deps     MANIFESTO  runtest-cluster   src</span><br><span class="line">CONTRIBUTING     INSTALL  README.md  runtest-sentinel  tests</span><br><span class="line">[root@localhost redis-3.2.8]# cd src</span><br><span class="line">[root@localhost src]# mv mkreleasehdr.sh redis-benchmark redis-check-aof redis-check-dump redis-cli redis-sentinel redis-server /usr/local/redis/bin/</span><br></pre></td></tr></table></figure>

<h3 id="启动redis服务"><a href="#启动redis服务" class="headerlink" title="启动redis服务"></a>启动redis服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[toor@localhost redis]$ cd bin</span><br><span class="line">[toor@localhost bin]$ ./redis-server</span><br></pre></td></tr></table></figure>

<p>显示结果：</p>
<p><img src="/img/redis-3.2.8%E5%AE%89%E8%A3%85.png" alt="结果"></p>
<p>但是，这样做的话，我们并没有使用etc的下的配置文件进行启动（图中红线部分）。</p>
<p>如果希望通过指定的配置文件启动，需要在启动时指定配置文件：</p>
<p>使用ctrl+C终止服务(显示错误，可以重试几次)，然后查看redis服务是否终止干净了，之后通过设置配置文件来启动服务</p>
<p>运行：<code>pstree -p | grep redis</code> 发现redis服务已经被终止干净</p>
<p>现在我们带上配置文件 /usr/local/etc/redis.conf 运行redis</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[toor@localhost bin]$  ./redis-server /usr/local/redis/etc/redis.conf</span><br></pre></td></tr></table></figure>

<p>启动结果：<br><img src="/img/redis-3.2.8%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C.png" alt="启动结果"></p>
<p>这样启动redis仍然在前台运行；</p>
<p>redis后台运行需要将daemonize由no改为yes</p>
<p>首先在超级权限下打开redis.conf。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost bin]# vim /usr/local/redis/etc/redis.conf</span><br></pre></td></tr></table></figure>

<p>保存退出，然后再次使用配置文件启动redis-server</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost bin]# ./redis-server /usr/local/redis/etc/redis.conf</span><br><span class="line">[root@localhost bin]# ps -ef|grep redis</span><br><span class="line">root     101598      1  0 17:04 ?        00:00:00 ./redis-server 127.0.0.1:6379</span><br><span class="line">root     101607 101338  0 17:04 pts/0    00:00:00 grep --color=auto redis</span><br><span class="line">[root@localhost bin]# pstree -p|grep redis</span><br><span class="line">           |-redis-server(101598)-+-&#123;redis-server&#125;(101601)</span><br><span class="line">           |                      `-&#123;redis-server&#125;(101602)</span><br></pre></td></tr></table></figure>

<p>详细参数说明：</p>
<p>daemonize 如果需要在后台运行，把该项改为yes</p>
<p>pidfile 配置多个pid的地址 默认在/var/run/redis.pid</p>
<p>bind 绑定ip，设置后只接受来自该ip的请求</p>
<p>port 监听端口，默认是6379</p>
<p>loglevel 分为4个等级：debug verbose notice warning</p>
<p>logfile 用于配置log文件地址</p>
<p>databases 设置数据库个数，默认使用的数据库为0</p>
<p>save 设置redis进行数据库镜像的频率。</p>
<p>rdbcompression 在进行镜像备份时，是否进行压缩</p>
<p>dbfilename 镜像备份文件的文件名</p>
<p>Dir 数据库镜像备份的文件放置路径</p>
<p>Slaveof 设置数据库为其他数据库的从数据库</p>
<p>Masterauth 主数据库连接需要的密码验证</p>
<p>Requriepass 设置 登陆时需要使用密码</p>
<p>Maxclients 限制同时使用的客户数量</p>
<p>Maxmemory 设置redis能够使用的最大内存</p>
<p>Appendonly 开启append only模式</p>
<p>Appendfsync 设置对appendonly.aof文件同步的频率（对数据进行备份的第二种方式）</p>
<p>vm-enabled 是否开启虚拟内存支持   （vm开头的参数都是配置虚拟内存的）</p>
<p>vm-swap-file 设置虚拟内存的交换文件路径</p>
<p>vm-max-memory 设置redis使用的最大物理内存大小</p>
<p>vm-page-size 设置虚拟内存的页大小</p>
<p>vm-pages 设置交换文件的总的page数量</p>
<p>vm-max-threads 设置VM IO同时使用的线程数量</p>
<p>Glueoutputbuf 把小的输出缓存存放在一起</p>
<p>hash-max-zipmap-entries 设置hash的临界值</p>
<p>Activerehashing 重新hash</p>
<p>Redis服务端默认连接端口是6379.</p>
<p>mysql 服务端默认连接端口是3306</p>
<p>Mogodb 服务端默认连接端口是27017，还有28017。</p>
<p>在平时，我们往往需要查看6379端口是否被占用。可以用以下命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[toor@localhost bin]$ netstat -tunpl | grep 6379</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">tcp        0      0 127.0.0.1:6379          0.0.0.0:*               LISTEN      -</span><br><span class="line">[toor@localhost bin]$ sudo netstat -tunpl | grep 6379</span><br><span class="line">[sudo] password for toor:</span><br><span class="line">toor is not in the sudoers file.  This incident will be reported.</span><br><span class="line">[toor@localhost bin]$ su root</span><br><span class="line">Password:</span><br><span class="line">[root@localhost bin]# netstat -tunpl | grep 6379</span><br><span class="line">tcp        0      0 127.0.0.1:6379          0.0.0.0:*               LISTEN      101598/./redis-serv </span><br></pre></td></tr></table></figure>

<p>注意，redis服务需要su权限才能查看，不然只能检查到6379被某个进程占用，但是看不到进程名称。</p>
<p>至此，redis服务已经按照配置文件启动成功！！</p>
<h3 id="客户端登陆"><a href="#客户端登陆" class="headerlink" title="客户端登陆"></a>客户端登陆</h3><p>进入 <code>/usr/local/redis/bin/</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost bin]# redis-cli</span><br><span class="line">127.0.0.1:6379&gt;</span><br><span class="line"></span><br><span class="line">[root@localhost bin]# redis-cli -h 192.168.1.131 -p 6379 # 指定主机，端口 -a password #指定密码</span><br><span class="line">192.168.1.131:6379&gt;</span><br><span class="line">[root@localhost bin]# redis-cli -h 192.168.1.131 -p 6379 shutdown # 关闭redis服务</span><br></pre></td></tr></table></figure>

<h3 id="关闭Redis服务"><a href="#关闭Redis服务" class="headerlink" title="关闭Redis服务"></a>关闭Redis服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost bin]# pkill redis-server</span><br><span class="line">[root@localhost bin]# netstat -tunpl | grep 6379</span><br><span class="line">[root@localhost bin]# pstree -p | grep redis</span><br><span class="line">[root@localhost bin]# redis-cli</span><br><span class="line">Could not connect to Redis at 127.0.0.1:6379: Connection refused</span><br><span class="line">Could not connect to Redis at 127.0.0.1:6379: Connection refused</span><br><span class="line">not connected&gt;</span><br></pre></td></tr></table></figure>

<p>也可以使用/usr/local/redis/bin/redis-cli shutdown，这种方法使用客户端命令redis-cli</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost bin]# ./redis-server /usr/local/redis/etc/redis.conf</span><br><span class="line">[root@localhost bin]# pstree -p | grep redis</span><br><span class="line">           |-redis-server(101927)-+-&#123;redis-server&#125;(101929)</span><br><span class="line">           |                      `-&#123;redis-server&#125;(101930)</span><br><span class="line">[root@localhost bin]# /usr/local/redis/bin/redis-cli shutdown</span><br><span class="line">[root@localhost bin]# pstree -p | grep redis</span><br><span class="line">[root@localhost bin]# sudo netstat -tunpl | grep 6379</span><br></pre></td></tr></table></figure>

<h3 id="开启远程访问端口"><a href="#开启远程访问端口" class="headerlink" title="开启远程访问端口"></a>开启远程访问端口</h3><p>开启端口：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=6379/tcp --permanent</span><br><span class="line">firewall-cmd --reload  <span class="comment">#重启防火墙</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 重新查询端口是否开放</span></span><br><span class="line">firewall-cmd --query-port=6379/tcp</span><br><span class="line"></span><br><span class="line"><span class="comment">## 查看监听的端口</span></span><br><span class="line">netstat -lnpt</span><br><span class="line"></span><br><span class="line"><span class="comment">#关闭6379端口</span></span><br><span class="line">firewall-cmd --zone=public --remove-port=6379/tcp --permanent  </span><br><span class="line"></span><br><span class="line"><span class="comment">## 查看防火墙所有开放的端口</span></span><br><span class="line">firewall-cmd --zone=public --list-ports</span><br></pre></td></tr></table></figure>

<p>命令含义：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--zone #作用域</span><br><span class="line">--add-port=6379/tcp #添加端口，格式为：端口/通讯协议</span><br><span class="line">--permanent #永久生效，没有此参数重启后失效</span><br></pre></td></tr></table></figure>

<h3 id="配置密码认证"><a href="#配置密码认证" class="headerlink" title="配置密码认证"></a>配置密码认证</h3><p>找到/usr/local/redis/etc/redis.conf文件中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requirepass foobared</span><br></pre></td></tr></table></figure>

<p>去掉注释，并且设置密码</p>
<p>重启redis</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost bin]# ./redis-server /usr/local/redis/etc/redis.conf</span><br><span class="line">[root@localhost bin]# redis-cli -h 192.168.1.131 -p 6379 -a toor</span><br><span class="line">192.168.1.131:6379&gt; keys *</span><br><span class="line">(empty list or set)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost bin]# ./redis-server /usr/local/redis/etc/redis.conf</span><br><span class="line">[root@localhost bin]# redis-cli -h 192.168.1.131 -p 6379</span><br><span class="line">192.168.1.131:6379&gt; keys *</span><br><span class="line">(error) NOAUTH Authentication required.</span><br><span class="line">192.168.1.131:6379&gt; auth toor</span><br><span class="line">OK</span><br><span class="line">192.168.1.131:6379&gt; keys *</span><br><span class="line">(empty list or set)</span><br></pre></td></tr></table></figure>

<p>master配置了密码，slave如何配置</p>
<p>若master配置了密码则slave也要配置相应的密码参数否则无法进行正常复制的。</p>
<p>slave中配置文件内找到如下行，移除注释，修改密码即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#masterauth  mstpassword</span><br></pre></td></tr></table></figure>

<p>参考：</p>
<p><a target="_blank" rel="noopener" href="http://www.open-open.com/lib/view/open1426468117367.html" title="参考链接">http://www.open-open.com/lib/view/open1426468117367.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/05/15/centos-7-rhel7-%E5%A6%82%E4%BD%95%E9%87%8D%E5%90%AF-%E5%81%9C%E6%AD%A2-%E5%90%AF%E5%8A%A8%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/15/centos-7-rhel7-%E5%A6%82%E4%BD%95%E9%87%8D%E5%90%AF-%E5%81%9C%E6%AD%A2-%E5%90%AF%E5%8A%A8%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1/" class="post-title-link" itemprop="url">centos7/rhel7: 如何重启/停止/启动网络服务</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-15 16:01:19" itemprop="dateCreated datePublished" datetime="2017-05-15T16:01:19+00:00">2017-05-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CentOS7/" itemprop="url" rel="index"><span itemprop="name">CentOS7</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="centos7-rhel7-如何重启-停止-启动网络服务"><a href="#centos7-rhel7-如何重启-停止-启动网络服务" class="headerlink" title="centos7/rhel7: 如何重启/停止/启动网络服务"></a>centos7/rhel7: 如何重启/停止/启动网络服务</h1><h2 id="重启网络服务"><a href="#重启网络服务" class="headerlink" title="重启网络服务"></a>重启网络服务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl retart network.service</span><br><span class="line">或</span><br><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure>

<h2 id="启动网络服务"><a href="#启动网络服务" class="headerlink" title="启动网络服务"></a>启动网络服务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start network.service</span><br><span class="line">或</span><br><span class="line">systemctl start network</span><br></pre></td></tr></table></figure>

<h2 id="停止网络服务"><a href="#停止网络服务" class="headerlink" title="停止网络服务"></a>停止网络服务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop network.service</span><br><span class="line">或</span><br><span class="line">systemctl stop network</span><br></pre></td></tr></table></figure>

<p>参考：<a target="_blank" rel="noopener" href="http://www.osetc.com/archives/1191.html" title="centos7/rhel7: 如何重启/停止/启动网络服务">http://www.osetc.com/archives/1191.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/05/10/CentOS7-%E5%AE%89%E8%A3%85MongoDB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/10/CentOS7-%E5%AE%89%E8%A3%85MongoDB/" class="post-title-link" itemprop="url">CentOS7 安装MongoDB</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-10 10:43:53" itemprop="dateCreated datePublished" datetime="2017-05-10T10:43:53+00:00">2017-05-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MongoDB/" itemprop="url" rel="index"><span itemprop="name">MongoDB</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h2><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p><a target="_blank" rel="noopener" href="https://www.mongodb.com/download-center?jmp=nav#community" title="链接">官网下载网址</a> </p>
<p>找到CentOS7最新下载包，</p>
<p><a target="_blank" rel="noopener" href="https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-3.4.4.tgz" title="下载链接">mongodb-linux-x86_64-rhel70-3.4.4.tgz</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/" title="链接">官方手册</a> </p>
<h3 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h3><p>在终端输入命令,如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压</span></span><br><span class="line">tar xzvf mongodb-linux-x86_64-rhel70-3.4.4.tgz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移动</span></span><br><span class="line">mv mongodb-linux-x86_64-rhel70-3.4.4 mongodb-3.4.4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建目录</span></span><br><span class="line"><span class="built_in">cd</span> mongodb-3.4.4</span><br><span class="line">mkdir logs</span><br><span class="line">mkdir db</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建配置文件</span></span><br><span class="line"><span class="built_in">cd</span> bin</span><br><span class="line">vim mongodb.conf</span><br></pre></td></tr></table></figure>

<p><strong>配置文件如下配置：</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># idae - MongoDB config start - 2017-05-10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置数据文件的存放目录</span></span><br><span class="line">dbpath = /usr/<span class="built_in">local</span>/mongodb/mongodb-3.4.4/db</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置日志文件的存放目录及其日志文件名</span></span><br><span class="line">logpath = /usr/<span class="built_in">local</span>/mongodb/mongodb-3.4.4/logs/mongodb.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置端口号（默认的端口号是 27017）</span></span><br><span class="line">port = 27017</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置为以守护进程的方式运行，即在后台运行</span></span><br><span class="line">fork = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nohttpinterface = true</span></span><br><span class="line">nohttpinterface = <span class="literal">true</span></span><br><span class="line"><span class="comment"># idae - MongoDB config end - 2016-05-10</span></span><br></pre></td></tr></table></figure>

<p><strong>参数解释</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">--dbpath 数据库路径(数据文件)</span><br><span class="line">--logpath 日志文件路径</span><br><span class="line">--master 指定为主机器</span><br><span class="line">--slave 指定为从机器</span><br><span class="line">--source 指定主机器的IP地址</span><br><span class="line">--pologSize 指定日志文件大小不超过64M.因为resync是非常操作量大且耗时，最好通过设置一个足够大的oplogSize来避免resync(默认的 oplog大小是空闲磁盘大小的5%)。</span><br><span class="line">--logappend 日志文件末尾添加，即使用追加的方式写日志</span><br><span class="line">--journal 启用日志</span><br><span class="line">--port 启用端口号</span><br><span class="line">--fork 在后台运行</span><br><span class="line">--only 指定只复制哪一个数据库</span><br><span class="line">--slavedelay 指从复制检测的时间间隔</span><br><span class="line">--auth 是否需要验证权限登录(用户名和密码)</span><br><span class="line">--syncdelay 数据写入硬盘的时间（秒），0是不等待，直接写入</span><br><span class="line">--notablescan 不允许表扫描</span><br><span class="line">--maxConns 最大的并发连接数，默认2000  </span><br><span class="line">--pidfilepath 指定进程文件，不指定则不产生进程文件</span><br><span class="line">--bind_ip 绑定IP，绑定后只能绑定的IP访问服务（服务器本地IP，非访问服务器客户端IP）</span><br></pre></td></tr></table></figure>

<p><strong>启动mongodb服务</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入mongodb-3.4.4/bin目录</span></span><br><span class="line"><span class="comment"># 自定义的 mongodb 配置文件方式启动</span></span><br><span class="line">./mongod --config mongodb.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止:</span></span><br><span class="line">./mongod --config mongodb.conf --shutdown</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修复模式启动 mongodb</span></span><br><span class="line">./mongod --repair -f mongodb.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以参数方式启动（在mongodb-3.4.4/bin目录下）:</span></span><br><span class="line">./mongod --dbpath=/usr/<span class="built_in">local</span>/mongodb/mongodb-3.4.4/db --logpath=/usr/<span class="built_in">local</span>/mongodb/mongodb-3.4.4/logs/mongodb.log --fork</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止：添加 --shutdown</span></span><br><span class="line">./mongod --dbpath=/usr/<span class="built_in">local</span>/mongodb/mongodb-3.4.4/db --logpath=/usr/<span class="built_in">local</span>/mongodb/mongodb-3.4.4/logs/mongodb.log --fork --shutdown</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加认证： --auth</span></span><br><span class="line"><span class="comment"># 连接</span></span><br><span class="line">./mongo 192.168.1.131:27017/admin -u root1 -p root1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果报如下错误：</span></span><br><span class="line"></span><br><span class="line">ERROR: child process failed, exited with error number 1</span><br><span class="line"><span class="comment"># 很可能是 mongodb.conf 中配置的路径不一致问题；</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果报如下错误：</span></span><br><span class="line"></span><br><span class="line">ERROR: child process failed, exited with error number 100</span><br><span class="line"><span class="comment"># 很可能是没有正常关闭导致的，那么可以删除 mongod.lock 文件</span></span><br><span class="line"><span class="comment"># number 100 ：端口问题</span></span><br></pre></td></tr></table></figure>

<p><strong>查看 mongodb 进程：</strong></p>
<p><code>ps aux | grep mongodb</code></p>
<p><strong>查看 mongodb 服务的运行日志：</strong></p>
<p> <code>tail -200f /usr/local/mongodb/mongodb-3.4.4/logs/mongodb.log</code></p>
<p><strong>检查端口是否已被启动：</strong></p>
<p><code>netstat -lanp | grep 27017</code></p>
<p><strong>杀死 mongodb 进程，即可关闭 mongodb 服务：(禁止使用，容易出现问题)</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -15 PID</span><br></pre></td></tr></table></figure>

<p><strong>连接错误</strong></p>
<p>1.若数据库出现如上不能连接的原因，可能是data目录下的mongod.lock文件问题，可以用如下命令修复：<br><code>./bin/mongod --repair</code></p>
<p>2.直接删除mongod.lock<br><code>rm -f /usr/local/mongodb/db/mongod.lock</code></p>
<p>3.然后再启动 mongodb 服务：<br><code>./mongod --config mongodb.conf</code></p>
<p>4.如果以上两部依然解决不掉，则是路径文件，我们可以删除 <code>/usr/local/mongodb/mongodb-3.4.4/db</code> 目录及其子目录，并采用绝对路径的方式：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./mongod /usr/<span class="built_in">local</span>/mongodb/mongodb-3.4.4/bin/mongod --dbpath=/usr/<span class="built_in">local</span>/mongodb/mongodb3.4.4/db --logpath=/usr/<span class="built_in">local</span>/mongodb/mongodb-3.4.4/logs/mongodb.log --fork</span><br></pre></td></tr></table></figure>

<p><strong>将 mongodb 服务加入到自启动文件中：</strong></p>
<p><code>vi /etc/rc.local</code></p>
<p>在文件末尾追加如下命令：</p>
<p><code>/usr/local/mongodb/mongodb-3.4.4/bin/mongod --config mongodb.conf</code></p>
<p>保存并退出：<br>:wq!</p>
<p>在 <code>/usr/local/mongodb/mongodb3.4.4/bin/</code> 目录中，键入如下命令，打开一个 mongodb 的客户端程序，即打开一个 mongodb 的 shell 客户端，这个 shell 客户端同时也是一个 JavaScript 编辑器，即可用输入任何的 JavaScript 脚本：</p>
<p><code>./mongo</code></p>
<p>在浏览器中输入 <code>IP:27017</code>，如：</p>
<p><code>http://127.0.0.1:27017/</code></p>
<p><strong>开启远程访问端口</strong></p>
<p>开启端口：</p>
<p><code>firewall-cmd --zone=public --add-port=27017/tcp --permanent</code></p>
<p>命令含义：<br>–zone #作用域<br>–add-port=27017/tcp #添加端口，格式为：端口/通讯协议<br>–permanent #永久生效，没有此参数重启后失效</p>
<p>重启防火墙:</p>
<p><code>firewall-cmd --reload</code></p>
<h3 id="安全和认证"><a href="#安全和认证" class="headerlink" title="安全和认证"></a>安全和认证</h3><p><strong>限制特定IP地址访问(MongoDB服务器IP地址)</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./mongod --bind_ip 192.168.1.131 --port 27017 --dbpath /usr/<span class="built_in">local</span>/mongodb/mongodb-3.4.4/db --logpath /usr/<span class="built_in">local</span>/mongodb/mongodb-3.4.4/logs/mongodb.log --fork</span><br></pre></td></tr></table></figure>

<p><strong>设置监听端口，并且需要在防火墙配置</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--port 27017</span><br></pre></td></tr></table></figure>

<p><strong>设置登录用户名和口令</strong></p>
<p>启用mongodb授权认证的方法：</p>
<p>1、以–auth 启动mongod</p>
<p>2、在配置文件mongod.conf 中加入 auth = true</p>
<p>添加用户：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.createUser(</span><br><span class="line">...   &#123;</span><br><span class="line">...     user: &quot;root1&quot;,</span><br><span class="line">...     pwd: &quot;root1&quot;,</span><br><span class="line">...     roles: [ &#123; role: &quot;__system&quot;, db: &quot;admin&quot; &#125; ]</span><br><span class="line">...   &#125;</span><br><span class="line">... )</span><br></pre></td></tr></table></figure>
<p>重新登录：<br><code>./mongo 192.168.1.131:27017 -u root1 -p root1</code></p>
<p>展示角色：<br><code>show roles</code></p>
<p>获取用户：<br><code>db.getUsers();</code></p>
<p>参考网址：</p>
<p><a target="_blank" rel="noopener" href="http://www.linuxidc.com/Linux/2016-06/132675.htm" title="链接">http://www.linuxidc.com/Linux/2016-06/132675.htm</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/05/02/CSharp-lock%E9%94%81%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/02/CSharp-lock%E9%94%81%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/" class="post-title-link" itemprop="url">CSharp lock锁深入理解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-02 10:41:19" itemprop="dateCreated datePublished" datetime="2017-05-02T10:41:19+00:00">2017-05-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CSharp%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">CSharp基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CSharp-lock锁深入理解"><a href="#CSharp-lock锁深入理解" class="headerlink" title="CSharp lock锁深入理解"></a>CSharp lock锁深入理解</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><h3 id="临界区（Critical-Section）"><a href="#临界区（Critical-Section）" class="headerlink" title="临界区（Critical Section）"></a>临界区（Critical Section）</h3><p>临界区是一段在同一时候只被一个线程进入/执行的代码块。</p>
<h3 id="Lock关键字"><a href="#Lock关键字" class="headerlink" title="Lock关键字"></a>Lock关键字</h3><p>将语句块标记为临界区，方法是获取给定对象的互斥锁，执行语句，然后释放该锁。此语句的形式如下：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Object thisLock = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line"><span class="keyword">lock</span> (thisLock)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Critical code section</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>lock 确保当一个线程位于代码的临界区时，另一个线程不进入临界区。如果其他线程试图进入锁定的代码，则它将一直等待（即被阻止），直到该对象被释放。</li>
</ul>
<h3 id="Lock使用准则"><a href="#Lock使用准则" class="headerlink" title="Lock使用准则"></a>Lock使用准则</h3><p>Lock 调用块开始位置的 Enter 和块结束位置的 Exit。</p>
<p>通常，应避免锁定 public 类型，否则实例将超出代码的控制范围。常见的结构 lock (this)、lock (typeof (MyType)) 和 lock (“myLock”) 违反此准则：</p>
<ul>
<li><p>如果实例可以被公共访问，将出现 lock (this) 问题。</p>
</li>
<li><p>如果 MyType 可以被公共访问，将出现 lock (typeof (MyType)) 问题。</p>
</li>
<li><p>由于进程中使用同一字符串的任何其他代码将共享同一个锁，所以出现lock(“myLock”) 问题。</p>
</li>
</ul>
<p>最佳做法是定义 private 对象来锁定, 或 private static 对象变量来保护所有实例所共有的数据。</p>
<p>针对上述三点原则我们用具体的代码来加深理解</p>
<h4 id="为什么不要Lock值类型"><a href="#为什么不要Lock值类型" class="headerlink" title="为什么不要Lock值类型"></a>为什么不要Lock值类型</h4><p>为什么不能lock值类型，比如lock(1)呢？让我们对上面的实例代码进行修改,将lock(thisLock)改为Lock(1),编译器时会出现int不是Lock语句要求的引用对象</p>
<p><img src="/img/lock1.png" alt="编译失败"></p>
<p>lock本质上Monitor.Enter，Monitor.Enter会使值类型装箱，每次lock的是装箱后的对象。lock其实是类似编译器的语法糖，因此编译器直接限制住不能lock值类型。</p>
<h4 id="不要使用lock-object-1"><a href="#不要使用lock-object-1" class="headerlink" title="不要使用lock((object)1)"></a>不要使用lock((object)1)</h4><p>经lock(thisLock)改为Lock((object)1)编译可以成功，说明代码块并没有锁.究其原因是因为Lock(对象)中,对象为引用类型,其是通过判断object.ReferenceEquals((object)1, (object)1)始终返回false（因为每次装箱后都是不同对象）,也就是说每次都会判断成未申请互斥锁，这样在同一时间，别的线程照样能够访问里面的代码，达不到同步的效果。</p>
<h4 id="不要使用Lock-this"><a href="#不要使用Lock-this" class="headerlink" title="不要使用Lock(this)"></a>不要使用Lock(this)</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TestLock</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestLockThis</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">bool</span> deadlocked = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">object</span> lockobject = <span class="keyword">new</span> <span class="built_in">object</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//这个方法用到了lock，我们希望lock的代码在同一时刻只能由一个线程访问</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LockMethod</span>(<span class="params"><span class="built_in">object</span> o</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//lock (this)</span></span><br><span class="line">            <span class="keyword">lock</span> (lockobject)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">while</span> (deadlocked)</span><br><span class="line">                &#123;</span><br><span class="line">                    deadlocked = (<span class="built_in">bool</span>)o;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;I am locked &quot;</span>);</span><br><span class="line">                    Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//所有线程都可以同时访问的方法</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">NotLockMethod</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;I am not locked &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            TestLockThis TestLockThis = <span class="keyword">new</span> TestLockThis();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//在t1线程中调用LockMe，并将deadlock设为true（将出现死锁）</span></span><br><span class="line">            Thread t1 = <span class="keyword">new</span> Thread(TestLockThis.LockMethod);</span><br><span class="line">            t1.Start(<span class="literal">true</span>);</span><br><span class="line">            Thread.Sleep(<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//在主线程中lock c1</span></span><br><span class="line">            <span class="keyword">lock</span> (TestLockThis)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//调用没有被lock的方法</span></span><br><span class="line">                TestLockThis.NotLockMethod();</span><br><span class="line">                <span class="comment">//调用被lock的方法，并试图将deadlock解除</span></span><br><span class="line">                TestLockThis.LockMethod(<span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Console.Read();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>在t1线程中，LockMethod调用了lock(this), 也就是Main函数中的c1，这时候在主线程中调用lock(TestLockThis)时，因为TestLockThis已经被锁定，所以必须要等待t1中的lock块执行完毕之后才能访问锁定的代码，即lock块中的所有操作都无法完成，于是我们看到连TestLockThis.NotLockMethod()都没有执行。</p>
<h4 id="Lock为什么不要Lock-null对象"><a href="#Lock为什么不要Lock-null对象" class="headerlink" title="Lock为什么不要Lock(null对象)"></a>Lock为什么不要Lock(null对象)</h4><p>使用Lock(null),会抛出异常</p>
<h4 id="Lock-本质"><a href="#Lock-本质" class="headerlink" title="Lock 本质"></a>Lock 本质</h4><p>Lock 关键字就是用Monitor 类来实现的。例如：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lock</span>(x)</span><br><span class="line">&#123;</span><br><span class="line">  DoSomething();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这等效于：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">System.Object obj = (System.Object)x;</span><br><span class="line">System.Threading.Monitor.Enter(obj);</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">  DoSomething();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">finally</span></span><br><span class="line">&#123;</span><br><span class="line">  System.Threading.Monitor.Exit(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用 lock 关键字通常比直接使用 Monitor 类更可取，一方面是因为 lock 更简洁，另一方面是因为 lock 确保了即使受保护的代码引发异常，也可以释放监视器。这是通过 finally 关键字来实现的，无论是否引发异常它都执行关联的代码块。</p>
<h4 id="Lock-对象推荐为只读静态对象"><a href="#Lock-对象推荐为只读静态对象" class="headerlink" title="Lock 对象推荐为只读静态对象"></a>Lock 对象推荐为只读静态对象</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">object</span> obj = <span class="keyword">new</span> <span class="built_in">object</span>();</span><br></pre></td></tr></table></figure>

<p>为什么要设置成只读的呢？这是因为如果在lock代码段中改变obj的值，其它线程就畅通无阻了，因为互斥锁的对象变了，object.ReferenceEquals必然返回false。</p>
<p>更准确的说，如果lock(object），object是静态的。那么说要该类的实例请求的都是一个object，所有实例执行的lock的时候只有一个能running。其他都必须等等。<br>lock(this)则表示锁住当前实例，实例内的所有线程必须等待，同一类的其他实例则可以有一个线程runing.</p>
<p>简单说lock(static objcet)在所有实例里锁住这段代码。<br>lock（this)锁住当前实例的这段代码。</p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/chengqscjh/archive/2010/12/12/1903784.html" title="深入理解CSharp Lock锁">http://www.cnblogs.com/chengqscjh/archive/2010/12/12/1903784.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/05/02/CSharp%20equal()%E5%92%8C=%E7%9A%84%E5%8C%BA%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/05/02/CSharp%20equal()%E5%92%8C=%E7%9A%84%E5%8C%BA%E5%88%AB/" class="post-title-link" itemprop="url">CSharp equal() 和 == 的区别</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-02 08:35:10" itemprop="dateCreated datePublished" datetime="2017-05-02T08:35:10+00:00">2017-05-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CSharp%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">CSharp基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CSharp中equal与-的区别"><a href="#CSharp中equal与-的区别" class="headerlink" title="CSharp中equal与==的区别"></a>CSharp中equal与==的区别</h1><p>C#中，判断相等有两种方式，一种是传统的==操作，一种是object提供的Equals方法。</p>
<p>二者的区别在于：</p>
<ul>
<li><p>一、==操作符判断的是堆栈中的值，Equlas判断的是堆中的值。</p>
<p>  C#提供值类型和引用类型，值类型存储在栈上，故用==判断是直接判断其值是否相等，因为值类型不存在堆中的数据，因此值类型的Equals也是判断数据。<br>  即，对于值类型而言，==与Equals相同，均是判断其值是否相等。</p>
<p>  对于引用类型而言，其栈中存储的是对象的地址，那么==就是比较两个地址是否相等，即是否指向同一个对象；Equals函数则是比较两个对象在堆中的数据<br>  是否一样，即两个引用类型是否是对同一个对象的引用。</p>
</li>
<li><p>二、String类型特殊</p>
<p>  String类型虽然是引用类型，但是对String对象的赋值却按照值类型操作。</p>
<p>  例如：</p>
  <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String s1=<span class="string">&quot;hello&quot;</span>;</span><br><span class="line">String s2=<span class="string">&quot;hello&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>  对s2初始化的时候，并没有重新开辟内存，而是直接将其地址指向s1的内容“hello”。这样一来，string类型虽然是引用类型，但是其==操作和Equals操作<br>  都是一样的，均比较值是否相等。</p>
</li>
<li><p>三、与GetHashCode()的关系</p>
<p>  若两对象Equals相等，那么其GetHashCode()必定相等；但是反过来，若GetHashCode()相等，那么这两个对象Equals方法比较结果不一定相同。</p>
<p> （为了获取最佳性能，hash函数为对象内容生成的数字是随机分布的，这就意味着，内容不同的对象，有可能生成的数字是一样的，但可以认为这种概率非常小）。</p>
<p>  下面示例说明：</p>
  <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApplication1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">People</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="built_in">string</span> name;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span> &#123; <span class="keyword">return</span> name; &#125;</span><br><span class="line">            <span class="keyword">set</span> &#123; name = <span class="keyword">value</span>; &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">People</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> a = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">            <span class="built_in">string</span> b = <span class="keyword">new</span> <span class="built_in">string</span>(<span class="keyword">new</span> <span class="built_in">char</span>[] &#123; <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span> &#125;);</span><br><span class="line">            Console.WriteLine(a == b);</span><br><span class="line">            Console.WriteLine(a.Equals(b));</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">            Int32 m = <span class="number">3</span>;</span><br><span class="line">            Int32 n = <span class="number">3</span>;</span><br><span class="line">            Console.WriteLine(n == m);</span><br><span class="line">            Console.WriteLine(n.Equals(m));</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">object</span> g = a;</span><br><span class="line">            <span class="built_in">object</span> h = b;</span><br><span class="line">            Console.WriteLine(g == h);</span><br><span class="line">            Console.WriteLine(g.Equals(h));</span><br><span class="line">            Console.WriteLine(g.GetHashCode() + <span class="string">&quot;   &quot;</span> + h.GetHashCode());</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">            People p1 = <span class="keyword">new</span> People(<span class="string">&quot;Jimmy&quot;</span>);</span><br><span class="line">            People p2 = <span class="keyword">new</span> People(<span class="string">&quot;Jimmy&quot;</span>);</span><br><span class="line">            Console.WriteLine(p1 == p2);</span><br><span class="line">            Console.WriteLine(p1.Equals(p2));</span><br><span class="line">            Console.WriteLine(p1.GetHashCode() + <span class="string">&quot;  &quot;</span> + p2.GetHashCode());</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">            People p3 = <span class="keyword">new</span> People(<span class="string">&quot;Jimmy&quot;</span>);</span><br><span class="line">            People p4 = p3;</span><br><span class="line">            Console.WriteLine(p3 == p4);</span><br><span class="line">            Console.WriteLine(p3.Equals(p4));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  运行结果：<br>  <img src="/img/equals.png" alt="运行结果"></p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://syxdevcode.github.com/2017/04/28/Hexo%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="syxdevcode">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="syxdevcode博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/04/28/Hexo%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">Hexo笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-04-28 09:47:46" itemprop="dateCreated datePublished" datetime="2017-04-28T09:47:46+00:00">2017-04-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-06 14:23:56" itemprop="dateModified" datetime="2021-06-06T14:23:56+00:00">2021-06-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hexo/" itemprop="url" rel="index"><span itemprop="name">Hexo</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Hexo-笔迹"><a href="#Hexo-笔迹" class="headerlink" title="Hexo 笔迹"></a>Hexo 笔迹</h1><h2 id="hexo文档"><a href="#hexo文档" class="headerlink" title="hexo文档"></a>hexo文档</h2><ul>
<li>官网：<a target="_blank" rel="noopener" href="https://hexo.io/" title="hexo官网">https://hexo.io/</a></li>
<li>参考教程1：<a target="_blank" rel="noopener" href="http://www.cnblogs.com/zhcncn/p/4097881.html" title="参考教程1">http://www.cnblogs.com/zhcncn/p/4097881.html</a></li>
<li>主题：<a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/wiki/Themes" title="主题">https://github.com/hexojs/hexo/wiki/Themes</a></li>
<li>更多主题：<a target="_blank" rel="noopener" href="http://theme-next.iissnan.com/theme-settings.html" title="更多主题">http://theme-next.iissnan.com/theme-settings.html</a></li>
</ul>
<h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><ul>
<li>hexo：查看帮助</li>
<li>hexo server ：本地启动命令，可以在本地浏览器浏览<ul>
<li>Ctrl+C 停止Server</li>
</ul>
</li>
<li>hexo new “My New Post” : 新建文档</li>
<li>hexo clean ：清除旧文档</li>
<li>hexo generate ：生成</li>
<li>hexo deploy ：部署</li>
</ul>
<h3 id="部署配置"><a href="#部署配置" class="headerlink" title="部署配置"></a>部署配置</h3><h4 id="生成-SSH-KEY"><a href="#生成-SSH-KEY" class="headerlink" title="生成 SSH KEY"></a>生成 SSH KEY</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot; GitHub 用户名 &quot;</span><br><span class="line">git config --global user.email &quot; GitHub 邮箱 &quot;</span><br><span class="line">ssh-keygen -t rsa -C &quot; 邮箱地址 &quot;</span><br></pre></td></tr></table></figure>

<p>1，SSH KEY 生成之后会默认保存在 C:/Users/电脑名用户名/.ssh 目录中，打开这个目录，打开 id_rsa.pub 文件，复制全部内容，即复制密钥</p>
<p>2，打开 GitHub ，依次点击 头像–&gt;Settings–&gt;SSH and GPG keys–&gt;Add SSH key，将复制的密钥粘贴到 key 输入框，最后点击 Add Key ，SSH KEY 配置成功</p>
<h3 id="添加图片"><a href="#添加图片" class="headerlink" title="添加图片"></a>添加图片</h3><ul>
<li>使用本地路径：在hexo/source目录下新建一个img文件夹，将图片放入该文件夹下，插入图片时链接即为/img/图片名称<ul>
<li>例如：<code>![配置](/img/mysql-workbench.png)</code></li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/28/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><span class="page-number current">29</span><a class="page-number" href="/page/30/">30</a><a class="extend next" rel="next" href="/page/30/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">syxdevcode</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">441</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">122</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">178</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/syxdevcode" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;syxdevcode" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">syxdevcode</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
